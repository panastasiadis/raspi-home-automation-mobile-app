(this["webpackJsonpio.cordova.hellocordova"]=this["webpackJsonpio.cordova.hellocordova"]||[]).push([[0],{234:function(e,n,t){},235:function(e,n,t){},266:function(e,n){},268:function(e,n){},303:function(e,n){},304:function(e,n){},306:function(e,n){},308:function(e,n){},317:function(e,n,t){"use strict";t.r(n);var a=t(1),c=t(0),i=t.n(c),o=t(13),s=t.n(o),r=(t(234),t(7)),l=(t(235),t(66)),d=t(22),u=t(393),p=t(128),m=t(364),j=t(394),g=t(142),b=t(387),h=t(363),x=t(187),O=t.n(x),f=t(52),v=t(63),y=t(28),C=t.n(y),N=function(){return sessionStorage.getItem("token")||null},k=function(){sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},I=function(e,n){sessionStorage.setItem("token",e),sessionStorage.setItem("user",JSON.stringify(n))},S="";document.addEventListener("deviceready",(function(){S="".concat(window.cordova.file.applicationDirectory,"www")}),!1);var w="http://192.168.1.66:5000/",T="http://192.168.1.66:8883";function R(){return Object(a.jsxs)(f.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ","Home Automation ",(new Date).getFullYear(),"."]})}var B=Object(v.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(S,"/static/media/home-automation3.2481b425.svg)"),backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function A(e){var n=B(),t=L(""),i=L(""),o=Object(c.useState)(null),s=Object(r.a)(o,2),l=s[0],d=s[1],x=Object(c.useState)(!1),v=Object(r.a)(x,2),y=(v[0],v[1]);return Object(a.jsxs)(h.a,{container:!0,component:"main",className:n.root,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(h.a,{item:!0,xs:!1,sm:4,md:7,className:n.image}),Object(a.jsx)(h.a,{item:!0,xs:12,sm:8,md:5,component:g.a,elevation:6,square:!0,children:Object(a.jsxs)("div",{className:n.paper,children:[Object(a.jsx)(u.a,{className:n.avatar,children:Object(a.jsx)(O.a,{})}),Object(a.jsx)(f.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:n.form,noValidate:!0,children:[Object(a.jsx)(j.a,{variant:"filled",color:"secondary",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,onChange:t.onChange}),Object(a.jsx)(j.a,{variant:"filled",color:"secondary",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:i.onChange}),l&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:"red"},children:l}),Object(a.jsx)("br",{})]}),Object(a.jsx)(p.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,onClick:function(){d(null),y(!0),C.a.post(w+"api/users/signin",{username:t.value,password:i.value}).then((function(n){y(!1),I(n.data.token,n.data.user),e.history.push("/dashboard")})).catch((function(e){console.log(e),console.log(e.response),alert(e),y(!1),e.response?401!==e.response.status&&400!==e.response.status||d(e.response.data.message):d("Something went wrong. Please try again later.")}))},children:"Sign In"}),Object(a.jsx)(b.a,{mt:5,children:Object(a.jsx)(R,{})})]})]})})]})}var L=function(e){var n=Object(c.useState)(e),t=Object(r.a)(n,2),a=t[0],i=t[1];return{value:a,onChange:function(e){i(e.target.value)}}},F=t(48),D=t(126);var M=function(e){var n=e.component,t=Object(D.a)(e,["component"]);return Object(a.jsx)(d.b,Object(F.a)(Object(F.a)({},t),{},{render:function(e){return N()?Object(a.jsx)(n,Object(F.a)({},e)):Object(a.jsx)(d.a,{to:{pathname:"/",state:{from:e.location}}})}}))};var z,G=function(e){var n=e.component,t=Object(D.a)(e,["component"]);return Object(a.jsx)(d.b,Object(F.a)(Object(F.a)({},t),{},{render:function(e){return N()?Object(a.jsx)(d.a,{to:{pathname:"/dashboard"}}):Object(a.jsx)(n,Object(F.a)({},e))}}))},W=t(62),E=t.n(W),P=t(107),H=t(96),q=t(188),_=t.n(q),U=T,V="mqttjs_brower_"+Math.random().toString(16).substr(2,4),J={keepalive:30,clientId:V,protocolId:"MQTT",protocolVersion:4,clean:!0,reconnectPeriod:1e3,connectTimeout:3e4,will:{topic:"WillMsg",payload:"Connection Closed abnormally..!",qos:0,retain:!1},rejectUnauthorized:!1},K={getClient:function(){return z||((z=_.a.connect(U,J)).subscribe("browser"),z.on("error",(function(e){console.log("Connection to ".concat(U," failed"),e),z.end()})),z.on("close",(function(){console.log(V+" disconnected")}))),z},publishMessage:function(e,n,t){e.publish(n,t)},subscribe:function(e,n){return e.subscribe(n,(function(e,n){e&&console.log("Subscription request failed")}))},onMessage:function(e,n){e.on("message",(function(t,a,c){console.log(a.toString(),t),n(e,t,a)}))},unsubscribe:function(e,n){e.unsubscribe(n)},closeConnection:function(e){e.end(),e=void 0},extractMqttTopicInfo:function(e){var n=e.split("/"),t=Object(r.a)(n,4);return{room:t[0],deviceId:t[1],type:t[2],sensorName:t[3]}}},Q=t(389),Y=t(390),X="Lightbulb",Z="Temperature-Humidity",$="Light-Intensity",ee=function(e,n){switch(e){case X:switch(n){case"ON":return{command:"ON",description:"Turn the lights on",commandOnFailure:"OFF"};case"OFF":return{command:"OFF",description:"Turn the lights off",commandOnFailure:"ON"};default:return[{command:"ON",description:"Turn the lights on",commandOnFailure:"OFF"},{command:"OFF",description:"Turn the lights off",commandOnFailure:"ON"}]}}},ne=function(e){switch(e){case"Temperature (Celcius)":return"Celcius";case"Humidity (%)":case"Light Intensity (%)":return"%"}};function te(e){return Object(a.jsx)(Q.a,Object(F.a)({elevation:6,variant:"filled"},e))}var ae=Object(v.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function ce(e){var n,t,i,o,s=ae(),l=Object(c.useState)(!!e.alertMessage),d=Object(r.a)(l,2),u=d[0],p=d[1],m=function(e,n){"clickaway"!==n&&p(!1)};if(Object(c.useEffect)((function(){p(!!e.alertMessage)}),[e]),e.alertMessage&&(n=e.alertMessage.device,t=e.alertMessage.reason),"connected"===t?i="success":"disconnected"===t?i="error":"action"===t&&(i="info"),"action"===t){var j=function(e,n){switch(e){case X:switch(n){case"ON":return"Turning the lights on!";case"OFF":return"Turning the lights off!"}}}(e.alertMessage.sensorType,e.alertMessage.command);o="".concat(e.alertMessage.actionCategory,": ").concat(j," (").concat(e.alertMessage.sensorType," | ").concat(e.alertMessage.roomName,")")}else o="".concat(n," was ").concat(t);return Object(a.jsx)("div",{className:s.root,children:Object(a.jsx)(Y.a,{open:u,onClose:m,autoHideDuration:6e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:Object(a.jsx)(te,{severity:i,onClose:m,children:o})})})}var ie=t(141),oe=t(61),se=t(4),re=t(396),le=t(383),de=t(381),ue=t(369),pe=t(378),me=t(210),je=t(385),ge=t(200),be=t.n(ge),he=t(201),xe=t.n(he),Oe=t(323),fe=t(374),ve=t(373),ye=t(401),Ce=t(370),Ne=t(46),ke=t.n(Ne),Ie=t(37),Se=t.n(Ie),we=t(38),Te=t.n(we),Re=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},imageLightOpen:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/lightbulb-open2.d67991f2.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},imageLightClosed:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/lightbulb-closed2.909d2ca0.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},currentState:{display:"flex",alignItems:"center",padding:e.spacing(1)},onOff:{marginLeft:e.spacing(1),padding:e.spacing(1),color:e.palette.secondary.main,borderStyle:"dashed",borderColor:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},circularProgress:{display:"inline","& > * + *":{marginLeft:e.spacing(2)}}}}));function Be(e){var n=Re(),t=Object(c.useState)("Loading..."),i=Object(r.a)(t,2),o=i[0],s=i[1],l="ON"===o,d=Object(c.useState)({spinner:!1,disabled:!0}),u=Object(r.a)(d,2),p=u[0],m=u[1];return Object(c.useEffect)((function(){var n=K.getClient(),t=function(n,t,a){console.log(t.toString(),n),n===e.topic&&(s(t.toString()),m({spinner:!1,disabled:!1}))};return n.on("message",t),function(){console.log("unmounting relay"),n.off("message",t)}}),[e.topic]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:["ON"===o?Object(a.jsx)("div",{className:n.imageLightOpen}):Object(a.jsx)("div",{className:n.imageLightClosed}),Object(a.jsxs)("div",{className:n.currentState,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Current state "}),Object(a.jsx)(f.a,{className:n.onOff,variant:"subtitle2",children:o})]}),!0===p.spinner?Object(a.jsx)("div",{className:n.circularProgress,children:Object(a.jsx)(Ce.a,{})}):null,Object(a.jsx)(ye.a,{onChange:function(n){var t=K.getClient();console.log(t,e.command),n.target.checked?K.publishMessage(t,e.command,"ON"):K.publishMessage(t,e.command,"OFF"),m({spinner:!0,disabled:!0})},checked:l,disabled:p.disabled})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Se.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Te.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.name})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(ke.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var Ae=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},progressBar:{textAlign:"center",width:"100%"},brightnessIcon:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/brightness.f2162df0.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:30,height:30},degrees:{textAlign:"center",backgroundColor:e.palette.secondary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"}}}));function Le(e){var n=Ae(),t=e.value;return e.value>100&&(t=100),Object(a.jsxs)(b.a,{position:"relative",display:"inline-flex",children:[Object(a.jsx)(Ce.a,{variant:"determinate",value:t,size:100}),Object(a.jsx)(b.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)("div",{className:n.brightnessIcon}),Object(a.jsx)(f.a,{variant:"body2",component:"div",color:"textSecondary",children:"".concat(Math.round(t),"%")})]})})]})}function Fe(e){var n=Ae(),t=Object(c.useState)({brightness:"Loading...",percentage:0}),o=Object(r.a)(t,2),s=o[0],l=o[1];return i.a.useEffect((function(){var n=K.getClient(),t=function(n,t,a){if(console.log(t.toString(),n),n===e.topic){var c=t.toString(),i=parseFloat(c);l({brightness:c,percentage:i})}};return n.on("message",t),function(){console.log("unmounting light intensity"),n.off("message",t)}}),[e.topic]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)("div",{className:n.progressBar,children:Object(a.jsx)(Le,{value:s.percentage})}),Object(a.jsx)(f.a,{className:n.degrees,children:"".concat(s.brightness," lux")})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Se.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Te.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(ke.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var De=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},degrees:{textAlign:"center",backgroundColor:e.palette.secondary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"},imageTemperature:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/thermometer.26bec6cd.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},imageHumidity:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/humidity.41d15f93.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},imageAverage:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/average.9152ffbf.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(1)},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},tempHum:{display:"flex",flexWrap:"wrap",justifyContent:"center"},averageMeasurementsDiv:{display:"flex",alignItems:"center",flexDirection:"column",backgroundColor:e.palette.secondary.main,padding:e.spacing(1),borderRadius:"10px",margin:e.spacing(1),color:"white"}}}));function Me(e){var n=De(),t=Object(c.useState)({avgTemp:null,avgHum:null,isFetching:!1}),i=Object(r.a)(t,2),o=i[0],s=i[1],l=Object(c.useState)({temperature:"Loading...",humidity:"Loading..."}),d=Object(r.a)(l,2),u=d[0],p=d[1],m="No Samples yet";return null!==o.avgTemp&&(m="".concat(Math.round(o.avgTemp),"\xb0C /\n    ").concat(Math.round(o.avgHum),"%")),Object(c.useEffect)((function(){(function(){var n=Object(H.a)(E.a.mark((function n(){var t,a,c,i,o,r,l;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s({avgTemp:null,avgHum:null,isFetching:!0}),n.next=4,C.a.get("".concat(w,"api/measurements/").concat(e.sensorName));case 4:t=n.sent,a=0,c=0,i=0,o=Object(P.a)(t.data);try{for(o.s();!(r=o.n()).done;)l=r.value,a+=l.temperaturesSum,c+=l.humiditiesSum,i+=l.measurementsCounter}catch(d){o.e(d)}finally{o.f()}console.log(t.data),0!==t.data.length&&s({avgTemp:a/=i,avgHum:c/=i,isFetching:!1}),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),console.log(n.t0),s({avgTemp:null,avgHum:null,isFetching:!1});case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(){return n.apply(this,arguments)}})()();var n=K.getClient(),t=function(n,t,a){if(console.log(t.toString(),n),n===e.topic){var c=t.toString().split("-");p({temperature:c[0],humidity:c[1]})}};return n.on("message",t),function(){console.log("unmounting temp-hum"),n.off("message",t)}}),[e.topic,e.sensorName]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.averageMeasurementsDiv,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Average"}),Object(a.jsx)("div",{className:n.imageAverage}),Object(a.jsx)(f.a,{className:n.degrees,children:m})]}),Object(a.jsxs)("div",{className:n.tempHum,children:[Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Temperature"}),Object(a.jsx)("div",{className:n.imageTemperature}),Object(a.jsxs)(f.a,{className:n.degrees,children:["".concat(u.temperature," \xb0C"),Object(a.jsx)("br",{})]})]}),Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Humidity"}),Object(a.jsx)("div",{className:n.imageHumidity}),Object(a.jsxs)(f.a,{className:n.degrees,children:[u.humidity," %",Object(a.jsx)("br",{})]})]})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Se.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Te.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(ke.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var ze=Object(v.a)((function(e){return{paper:{padding:e.spacing(1),display:"flex",overflow:"auto",flexDirection:"column",backgroundColor:e.palette.secondary.main,borderRadius:"10px"},title:{backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),textAlign:"center"},roomTitle:{textAlign:"center",backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),margin:e.spacing(1)}}}));function Ge(e){var n=ze();return e.sensor.type===$?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Room brightness"}),Object(a.jsx)(Fe,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===Z?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Temperature & Humidity"}),Object(a.jsx)(Me,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===X?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Lights"}),Object(a.jsx)(Be,{roomName:e.sensor.room,device:e.sensor.deviceId,name:e.sensor.name,command:e.sensor.commandTopic,topic:e.sensor.pubTopic})]})}):null}var We=Object(v.a)((function(e){return{image:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/not-found.cd5a9b2a.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:"80vh",height:"50vh"},divNoContent:{margin:e.spacing(1),display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},title:{margin:e.spacing(1),padding:e.spacing(1),color:"white",textAlign:"center"}}}));function Ee(e){var n=We();return Object(a.jsxs)("div",{className:n.divNoContent,children:[Object(a.jsx)(f.a,{variant:"h3",component:"h3",gutterBottom:!0,className:n.title,children:e.displayItem?"No ".concat(e.displayItem," Found"):"Nothing Found"}),Object(a.jsx)("div",{className:n.image})]})}var Pe=Object(v.a)((function(e){return{paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",backgroundColor:e.palette.secondary.main}}}));function He(e){var n=Pe(),t=e.sensors;return"room"===e.filtered?t=e.sensors.filter((function(n){return n.room===e.selected})):"sensor-type"===e.filtered&&(t=e.sensors.filter((function(n){return n.type===e.selected}))),0===t.length?Object(a.jsx)(g.a,{className:n.paper,elevation:10,children:Object(a.jsx)(Ee,{displayItem:"Devices"})}):Object(a.jsx)(h.a,{container:!0,spacing:3,justify:"center",children:t.map((function(e){return Object(a.jsx)(Ge,{sensor:e},e.name)}))})}var qe=t(202),_e=t.n(qe),Ue=t(203),Ve=t.n(Ue),Je=t(204),Ke=t.n(Je),Qe=t(372),Ye=t(371),Xe=t(321),Ze=t(189),$e=t.n(Ze),en=t(190),nn=t.n(en),tn=t(191),an=t.n(tn),cn=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},dialogPaper:{},emptyContentLabel:{margin:36}}}));function on(e){var n=cn(),t=e.onClose,c=e.open;return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{classes:{paper:n.dialogPaper},onClose:function(){t(void 0)},"aria-labelledby":"simple-dialog-title",open:c,children:[Object(a.jsx)(Ye.a,{id:"simple-dialog-title",children:e.name}),0!==e.contents.length?Object(a.jsx)(ue.a,{children:e.contents.map((function(c){return Object(a.jsxs)(Oe.a,{button:!0,onClick:function(){t(c)},children:[Object(a.jsx)(Qe.a,{children:Object(a.jsx)(u.a,{className:n.avatar,children:"room"===e.type?Object(a.jsx)($e.a,{}):Object(a.jsx)(nn.a,{})})}),Object(a.jsx)(ve.a,{primary:c})]},c)}))}):Object(a.jsxs)(f.a,{variant:"body1",color:"secondary",align:"center",className:n.emptyContentLabel,children:["No ",e.name," found."]})]})})}function sn(e){var n=i.a.useState(!1),t=Object(r.a)(n,2),c=t[0],o=t[1],s=i.a.useState(void 0),l=Object(r.a)(s,2),d=l[0],u=l[1];return Object(a.jsxs)("div",{children:[Object(a.jsxs)(Oe.a,{button:!0,onClick:function(){o(!0)},children:[Object(a.jsx)(fe.a,{children:"room"===e.type?Object(a.jsx)(Se.a,{color:"primary"}):Object(a.jsx)(an.a,{color:"primary"})}),Object(a.jsx)(ve.a,{primary:e.name})]}),Object(a.jsx)(on,{name:e.name,type:e.type,contents:e.contents,selectedValue:d,open:c,onClose:function(n){o(!1),u(n),n&&e.selectItem({selected:n,type:e.type})}})]})}var rn=t(384),ln=t(391),dn=t(377),un=t(376),pn=t(195),mn=t.n(pn),jn=t(325),gn=t(324),bn=t(375),hn=t(192),xn=t.n(hn);function On(e){var n=i.a.useState(!1),t=Object(r.a)(n,2),o=t[0],s=t[1],l=Object(c.useState)(null),d=Object(r.a)(l,2),u=d[0],m=d[1],j=function(){s(!1),m(null)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(me.a,{onClick:function(){s(!0)},color:"primary",children:Object(a.jsx)(xn.a,{})}),Object(a.jsxs)(Xe.a,{open:o,onClose:j,"aria-labelledby":"responsive-dialog-title",children:[Object(a.jsx)(Ye.a,{id:"responsive-dialog-title",children:"Warning"}),Object(a.jsxs)(gn.a,{children:[Object(a.jsx)(bn.a,{children:"Are you sure you want to delete this action?"}),u&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:"red"},children:u}),Object(a.jsx)("br",{})]})]}),Object(a.jsxs)(jn.a,{children:[Object(a.jsx)(p.a,{variant:"contained",autoFocus:!0,onClick:j,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",autoFocus:!0,onClick:function(){m(null),C.a.delete("".concat(w,"api/actions/").concat(e.action._id),{data:e.action._id}).then((function(n){e.updateActions(e.action._id.toString()+Math.random().toString(16).substr(2,8)),s(!1)})).catch((function(e){console.log(e.response),e.response?404===e.response.status&&m(e.response.data.message):m("Something went wrong. Please try again later.")}))},color:"primary",children:"Delete"})]})]})]})}var fn=t(193),vn=t.n(fn),yn=t(194),Cn=t.n(yn),Nn=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},timeInfoIndividual:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1)},dateLabel:{marginLeft:e.spacing(1)}}}));function kn(e){var n=Nn();return Object(a.jsxs)("div",{className:n.accordionContent,children:[Object(a.jsxs)("div",{className:n.timeInfoIndividual,children:[Object(a.jsx)(vn.a,{}),Object(a.jsx)(f.a,{className:n.dateLabel,variant:"subtitle1",children:"Starting time: ".concat(e.date.toLocaleString())})]}),Object(a.jsxs)("div",{className:n.timeInfoIndividual,children:[Object(a.jsx)(Cn.a,{}),Object(a.jsx)(f.a,{className:n.dateLabel,variant:"subtitle1",children:e.recurrenceMessage})]})]})}var In=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},whenDescription:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),flexWrap:"wrap"},whenSensorDescription:{borderRadius:"10px",backgroundColor:"white",display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),flexWrap:"wrap"},labelDynamicContent:{marginLeft:e.spacing(1),marginRight:e.spacing(1),backgroundColor:e.palette.primary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),borderRadius:"10px"},deviceInfoIndividual:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},deviceInfo:Object(oe.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},e.breakpoints.down("md"),{marginTop:e.spacing(2)})}}));function Sn(e){var n=In();return Object(a.jsxs)("div",{className:n.accordionContent,children:[Object(a.jsx)("div",{className:n.whenDescription,children:Object(a.jsx)(f.a,{variant:"subtitle1",children:"When ".concat(e.measurementType.toLowerCase()," is ").concat(e.comparisonType.toLowerCase()," ").concat(e.quantity," ").concat(ne(e.measurementType),".")})}),Object(a.jsx)("div",{className:n.whenSensorDescription,children:Object(a.jsx)(f.a,{variant:"subtitle1",color:"secondary",children:"Sensor: "+e.measurementSensorType})}),Object(a.jsxs)("div",{className:n.whenSensorDescription,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Se.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementRoomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Te.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementSensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(ke.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementDeviceId})]})]})]})}var wn=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},info:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1)},label:{marginLeft:e.spacing(1)},radiusMeters:{marginLeft:e.spacing(1),paddingLeft:e.spacing(1),paddingRight:e.spacing(1),backgroundColor:e.palette.primary.main,borderRadius:"10px",color:"white"}}}));function Tn(e){var n=wn();return Object(a.jsx)("div",{className:n.accordionContent,children:Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsx)("img",{src:"".concat(S,"/static/media/home-location.cc2515ec.svg"),alt:"Home Location",width:"35",height:"35"}),Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"Radius:"}),Object(a.jsx)(f.a,{className:n.radiusMeters,variant:"subtitle1",children:"".concat(e.radius)}),Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"meters"})]})})}var Rn=Object(v.a)((function(e){return{root:{width:"100%"},command:{color:e.palette.primary.main,fontSize:e.typography.pxToRem(15),padding:e.spacing(1),margin:e.spacing(1),flexShrink:0,borderStyle:"solid",borderColor:e.palette.primary.main,borderRadius:"10px",backgroundColor:e.palette.secondary.main},headingCommand:{borderColor:e.palette.secondary.main,borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center"},heading:{width:"100px",margin:e.spacing(1),flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary,padding:e.spacing(1),margin:e.spacing(1)},summary:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-start"},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},deviceInfo:Object(oe.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},e.breakpoints.down("md"),{marginTop:e.spacing(2)}),deleteButton:{display:"flex",justifyContent:"center"}}}));function Bn(e){var n=Rn(),t=i.a.useState(!1),c=Object(r.a)(t,2),o=c[0],s=c[1],l=null;switch(e.action.actionCategory){case"Timer Action":var d,u;u=e.action.recurrenceNumber?"Every ".concat(e.action.recurrenceNumber," ").concat(e.action.recurrenceTimeUnit):"None",d=new Date(e.action.startTime),l=Object(a.jsx)(kn,{recurrenceMessage:u,date:d});break;case"Sensor-Based Action":l=Object(a.jsx)(Sn,{measurementType:e.action.measurementType,quantity:e.action.quantity,comparisonType:e.action.comparisonType,measurementSensorName:e.action.measurementSensorName,measurementDeviceId:e.action.measurementDeviceId,measurementRoomName:e.action.measurementRoomName,measurementSensorType:e.action.measurementSensorType});break;case"Location-Based Action":l=Object(a.jsx)(Tn,{radius:e.action.radius})}var p,m=ee(e.action.sensorType,e.action.command),j=new Date(e.action.registrationDate);return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(ln.a,{expanded:"panel1"===o,onChange:(p="panel1",function(e,n){s(!!n&&p)}),children:[Object(a.jsx)(un.a,{expandIcon:Object(a.jsx)(mn.a,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:Object(a.jsxs)("div",{className:n.summary,children:[Object(a.jsxs)("div",{className:n.headingCommand,children:[Object(a.jsx)(f.a,{variant:"subtitle1",className:n.heading,children:e.action.actionCategory}),Object(a.jsxs)(f.a,{className:n.command,children:[e.action.sensorType+" | ",m.description]})]}),Object(a.jsxs)("div",{className:n.deviceInfo,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Se.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Te.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(ke.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.deviceId})]})]}),Object(a.jsxs)(f.a,{className:n.secondaryHeading,children:["Registered on: ",j.toLocaleString()]})]})}),Object(a.jsx)(dn.a,{children:l}),Object(a.jsx)(pe.a,{}),Object(a.jsx)("div",{className:n.deleteButton,children:Object(a.jsx)(On,{action:e.action,updateActions:e.updateActions})})]})})}var An=t(399),Ln=t(400),Fn=t(392),Dn=t(199),Mn=t.n(Dn),zn=t(198),Gn=t.n(zn),Wn=t(205),En=t(23),Pn=t(380),Hn=t(402),qn=t(398),_n=t(379),Un=t(367),Vn=t(388),Jn=Object(v.a)((function(e){return{button:{display:"block",marginTop:e.spacing(2)},formControl:{minWidth:120,maxWidth:250},menuItem:{padding:e.spacing(1),display:"flex"}}}));function Kn(e){var n=Jn(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(!1),d=Object(r.a)(l,2),u=d[0],p=d[1],m=null;return e.sensors&&(void 0===e.isCommandSensor?m=e.sensors:e.isCommandSensor?m=e.sensors.filter((function(e){return e.commandTopic})):e.isCommandSensor||(m=e.sensors.filter((function(e){return!e.commandTopic})))),Object(a.jsx)("div",{children:Object(a.jsxs)(Un.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(qn.a,{id:"demo-controlled-open-select-label",children:"Sensor"}),Object(a.jsxs)(Vn.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){p(!1)},onOpen:function(){p(!0)},value:o,onChange:function(n){s(n.target.value),e.selectSensor(n.target.value)},children:[Object(a.jsx)(_n.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),m?m.map((function(e){return Object(a.jsxs)(_n.a,{value:e,children:[Object(a.jsx)(Te.a,{}),"  ",e.name,"  ",Object(a.jsx)(Se.a,{}),"  ",e.room,"  ",Object(a.jsx)(ke.a,{}),"  ",e.deviceId]},e.name)})):null]})]})})}var Qn=Object(v.a)((function(e){return{formControl:{minWidth:120},menuItem:{padding:e.spacing(1)}}}));function Yn(e){var n=Qn(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(!1),d=Object(r.a)(l,2),u=d[0],p=d[1],m=ee(e.type);return Object(a.jsx)("div",{children:Object(a.jsxs)(Un.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(qn.a,{id:"demo-controlled-open-select-label",children:"Command"}),Object(a.jsx)(Vn.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){p(!1)},onOpen:function(){p(!0)},value:o,onChange:function(n){s(n.target.value),e.selectCommand(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(_n.a,{value:e.command,children:e.description},n)})):null})]})})}var Xn=t(5),Zn=t(213),$n=Object(Xn.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(Zn.a),et=Object(v.a)((function(e){return{margin:{margin:e.spacing(1)}}}));function nt(e){var n=et(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(""),d=Object(r.a)(l,2),u=d[0],p=d[1];console.log(o);return Object(a.jsxs)("div",{children:[Object(a.jsxs)(Un.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(qn.a,{htmlFor:"demo-customized-textbox",children:"Recurrence every"}),Object(a.jsx)($n,{type:"number",id:"demo-customized-textbox",value:o,onChange:function(n){s(n.target.value),e.selectRecurrence(n.target.value)}})]}),Object(a.jsxs)(Un.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(qn.a,{id:"demo-customized-select-label",children:"Units"}),Object(a.jsxs)(Vn.a,{labelId:"demo-customized-select-label",id:"demo-customized-select",value:u,onChange:function(n){p(n.target.value),e.selectTimeUnits(n.target.value)},input:Object(a.jsx)($n,{}),children:[Object(a.jsx)(_n.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),Object(a.jsx)(_n.a,{value:"Minutes",children:"Minutes"}),Object(a.jsx)(_n.a,{value:"Hours",children:"Hours"}),Object(a.jsx)(_n.a,{value:"Days",children:"Days"})]})]})]})}var tt=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},extendedIcon:{marginRight:e.spacing(1)},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(4)},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)}}}));function at(e){var n=tt(),t=i.a.useState(!0),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(new Date),d=Object(r.a)(l,2),u=d[0],m=d[1],j=i.a.useState(""),g=Object(r.a)(j,2),b=g[0],h=g[1],x=i.a.useState(""),O=Object(r.a)(x,2),f=O[0],v=O[1],y=i.a.useState(""),N=Object(r.a)(y,2),k=N[0],I=N[1],S=i.a.useState(""),T=Object(r.a)(S,2),R=T[0],B=T[1],A=i.a.useState({message:null,color:null}),L=Object(r.a)(A,2),F=L[0],D=L[1],M=i.a.useState(!1),z=Object(r.a)(M,2),G=z[0],W=z[1],E=function(e){m(e)},P=function(){e.closeDialog(),s(!1),D({message:null,color:null}),h(""),v(""),I(""),B(""),m(new Date)};return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:o,onClose:P,children:[Object(a.jsx)(Ye.a,{children:"Schedule an action"}),Object(a.jsxs)(gn.a,{dividers:!0,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Kn,{sensors:e.sensors,isCommandSensor:!0,selectSensor:h})}),""===b?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Yn,{type:b.type,selectCommand:v})}),Object(a.jsxs)(En.a,{utils:Wn.a,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Pn.a,{margin:"normal",id:"date-picker-dialog",label:"Starting Date Picker",format:"MM/dd/yyyy",value:u,onChange:E,KeyboardButtonProps:{"aria-label":"change date"}})}),Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Hn.a,{margin:"normal",id:"time-picker",label:"Starting Time Picker",value:u,onChange:E,KeyboardButtonProps:{"aria-label":"change time"}})})]}),Object(a.jsx)(nt,{selectRecurrence:I,selectTimeUnits:B}),F.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:F.color},children:F.message}),Object(a.jsx)("br",{})]})]}),Object(a.jsx)(jn.a,{children:!0===G?Object(a.jsx)(Ce.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{className:n.cancelButton,variant:"contained",onClick:P,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",onClick:function(){D({message:null,color:null}),W(!0),C.a.post(w+"api/timerActions",{sensorType:b.type,sensorName:b.name,deviceId:b.deviceId,roomName:b.room,command:f,commandTopic:b.commandTopic,registrationDate:Date.now(),timestamp:u,recurrenceTimeUnit:R,recurrenceNumber:k}).then((function(n){e.updateActions(n.data._id),W(!1),D({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),D({message:e.response.data.message,color:"red"})),W(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var ct=Object(Xn.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:14,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(Zn.a),it=Object(v.a)((function(e){return{margin:{margin:e.spacing(1)}}}));function ot(e){var n=it(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(""),d=Object(r.a)(l,2),u=d[0],p=d[1];return Object(a.jsxs)("div",{children:[Object(a.jsxs)(Un.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(qn.a,{required:!0,id:"demo-customized-select-label",children:"Compare"}),Object(a.jsxs)(Vn.a,{labelId:"demo-customized-select-label",id:"demo-customized-select",value:u,onChange:function(n){p(n.target.value),e.selectComparison(n.target.value)},input:Object(a.jsx)(ct,{}),children:[Object(a.jsx)(_n.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),Object(a.jsx)(_n.a,{value:"Below",children:"Below"}),Object(a.jsx)(_n.a,{value:"Over",children:"Over"}),Object(a.jsx)(_n.a,{value:"Equal To",children:"Equal To"})]})]}),Object(a.jsxs)(Un.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(qn.a,{required:!0,htmlFor:"demo-customized-textbox",children:"Quantity"}),Object(a.jsx)(ct,{type:"number",id:"demo-customized-textbox",value:o,onChange:function(n){s(n.target.value),e.selectQuantity(n.target.value)}})]})]})}var st=Object(v.a)((function(e){return{formControl:{minWidth:130},menuItem:{padding:e.spacing(1)}}}));function rt(e){var n=st(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(!1),d=Object(r.a)(l,2),u=d[0],p=d[1],m=function(e){switch(e){case Z:return["Temperature (Celcius)","Humidity (%)"];case $:return["Light Intensity (%)"]}}(e.type);return Object(a.jsx)("div",{children:Object(a.jsxs)(Un.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(qn.a,{id:"demo-controlled-open-select-label",children:"Measurement"}),Object(a.jsx)(Vn.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){p(!1)},onOpen:function(){p(!0)},value:o,onChange:function(n){s(n.target.value),e.selectMeasurementType(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(_n.a,{value:e,children:e},n)})):null})]})})}var lt=Object(v.a)((function(e){return{root:{display:"flex"},wrapDiv:{display:"flex",justifyContent:"flex-start",flexDirection:"column"},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)},label:{marginTop:e.spacing(2),marginBottom:e.spacing(2),paddingLeft:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px"}}}));function dt(e){var n=lt(),t=i.a.useState(!0),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(""),d=Object(r.a)(l,2),u=d[0],m=d[1],j=i.a.useState(""),g=Object(r.a)(j,2),b=g[0],h=g[1],x=i.a.useState(""),O=Object(r.a)(x,2),v=O[0],y=O[1],N=i.a.useState(""),k=Object(r.a)(N,2),I=k[0],S=k[1],T=i.a.useState(""),R=Object(r.a)(T,2),B=R[0],A=R[1],L=i.a.useState(""),F=Object(r.a)(L,2),D=F[0],M=F[1],z=i.a.useState({message:null,color:null}),G=Object(r.a)(z,2),W=G[0],E=G[1],P=i.a.useState(!1),H=Object(r.a)(P,2),q=H[0],_=H[1],U=function(){e.closeDialog(),s(!1),E({message:null,color:null}),h(""),m(""),y(""),S(""),A(""),M("")};return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:o,onClose:U,children:[Object(a.jsx)(Ye.a,{children:"Sensor-Based Action"}),Object(a.jsx)(gn.a,{dividers:!0,children:Object(a.jsxs)("div",{className:n.wrapDiv,children:[Object(a.jsxs)("div",{className:n.picker,children:[Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"Trigger"}),Object(a.jsx)(Kn,{sensors:e.sensors,selectSensor:h,isCommandSensor:!0})]}),""===b?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Yn,{type:b.type,selectCommand:y})}),Object(a.jsxs)("div",{className:n.picker,children:[Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"When"}),Object(a.jsx)(Kn,{sensors:e.sensors,selectSensor:m,isCommandSensor:!1})]}),""===u?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(rt,{type:u.type,selectMeasurementType:S})}),Object(a.jsx)(ot,{selectComparison:M,selectQuantity:A}),W.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:W.color},children:W.message}),Object(a.jsx)("br",{})]})]})}),Object(a.jsx)(jn.a,{children:!0===q?Object(a.jsx)(Ce.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{className:n.cancelButton,variant:"contained",onClick:U,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",onClick:function(){E({message:null,color:null}),_(!0);var n=ee(b.type,v).commandOnFailure;C.a.post(w+"api/sensorBasedActions",{sensorType:b.type,sensorName:b.name,deviceId:b.deviceId,roomName:b.room,command:v,commandTopic:b.commandTopic,registrationDate:Date.now(),measurementSensorName:u.name,measurementDeviceId:u.deviceId,measurementRoomName:u.room,measurementSensorType:u.type,commandOnFailure:n,comparisonType:D,quantity:B,measurementType:I}).then((function(n){e.updateActions(n.data._id),_(!1),E({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),E({message:e.response.data.message,color:"red"})),_(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var ut=t(196),pt=t.n(ut),mt=function(e){BackgroundGeolocation.configure({locationProvider:BackgroundGeolocation.ACTIVITY_PROVIDER,desiredAccuracy:BackgroundGeolocation.HIGH_ACCURACY,stationaryRadius:50,distanceFilter:500,notificationTitle:"Background Tracking",notificationText:"Enabled",debug:!0,interval:1e4,fastestInterval:5e3,activitiesInterval:1e4,url:"http://192.168.1.66:5000/api/location",httpHeaders:{"X-FOO":"bar"},postTemplate:{lat:"@latitude",lon:"@longitude"}}),BackgroundGeolocation.on("location",(function(e){console.log(e),BackgroundGeolocation.startTask((function(e){BackgroundGeolocation.endTask(e)}))})),BackgroundGeolocation.on("stationary",(function(e){})),BackgroundGeolocation.on("error",(function(e){console.log("[ERROR] BackgroundGeolocation error:",e.code,e.message)})),BackgroundGeolocation.on("start",(function(){console.log("[INFO] BackgroundGeolocation service has been started")})),BackgroundGeolocation.on("stop",(function(){console.log("[INFO] BackgroundGeolocation service has been stopped")})),BackgroundGeolocation.on("authorization",(function(e){console.log("[INFO] BackgroundGeolocation authorization status: "+e),e!==BackgroundGeolocation.AUTHORIZED&&setTimeout((function(){if(confirm("App requires location tracking permission.\nIf you are willing to give all the required permissions, restart the app for the changes to take effect.\nWould you like to open app settings? "))return BackgroundGeolocation.showAppSettings()}),1e3)})),BackgroundGeolocation.on("background",(function(){console.log("[INFO] App is in background")})),BackgroundGeolocation.on("foreground",(function(){console.log("[INFO] App is in foreground")})),BackgroundGeolocation.on("abort_requested",(function(){console.log("[INFO] Server responded with 285 Updates Not Required")})),BackgroundGeolocation.on("http_authorization",(function(){console.log("[INFO] App needs to authorize the http requests")})),BackgroundGeolocation.checkStatus((function(n){console.log("[INFO] BackgroundGeolocation service is running",n.isRunning),console.log("[INFO] BackgroundGeolocation services enabled",n.locationServicesEnabled),console.log("[INFO] BackgroundGeolocation auth status: "+n.authorization),console.log(n.isRunning),!n.isRunning&&n.locationServicesEnabled?(BackgroundGeolocation.start(),e(!0)):n.isRunning||BackgroundGeolocation.removeAllListeners()}))};document.addEventListener("deviceready",mt,!1);var jt=Object(Xn.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:14,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(Zn.a),gt=Object(v.a)((function(e){return{margin:{margin:e.spacing(1),paddingTop:e.spacing(1)}}}));function bt(e){var n=gt(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1];return Object(a.jsx)("div",{children:Object(a.jsxs)(Un.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(qn.a,{required:!0,htmlFor:"demo-customized-textbox",children:"Radius in meters (Minimum: 100)"}),Object(a.jsx)(jt,{type:"number",id:"demo-customized-textbox",value:o,onChange:function(n){s(n.target.value),e.selectRadius(n.target.value)}})]})})}var ht=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},extendedIcon:{marginRight:e.spacing(1)},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(4)},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)},label:{marginTop:e.spacing(2),marginBottom:e.spacing(2),padding:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px"}}}));function xt(e){var n=ht(),t=i.a.useState(!0),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(""),d=Object(r.a)(l,2),u=d[0],m=d[1],j=i.a.useState(""),g=Object(r.a)(j,2),b=g[0],h=g[1],x=i.a.useState(""),O=Object(r.a)(x,2),f=O[0],v=O[1],y=i.a.useState({message:null,color:null}),N=Object(r.a)(y,2),k=N[0],I=N[1],S=i.a.useState(!1),T=Object(r.a)(S,2),R=T[0],B=T[1],A=function(){e.closeDialog(),s(!1),I({message:null,color:null}),m(""),h(""),v("")};return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:o,onClose:A,children:[Object(a.jsx)(Ye.a,{children:"Location-Based Action"}),Object(a.jsxs)(gn.a,{dividers:!0,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Kn,{sensors:e.sensors,isCommandSensor:!0,selectSensor:m})}),""===u?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Yn,{type:u.type,selectCommand:h})}),Object(a.jsx)(bt,{selectRadius:v}),k.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:k.color},children:k.message}),Object(a.jsx)("br",{})]})]}),Object(a.jsx)(jn.a,{children:!0===R?Object(a.jsx)(Ce.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{className:n.cancelButton,variant:"contained",onClick:A,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",onClick:function(){I({message:null,color:null}),B(!0),C.a.post(w+"api/locationBasedActions",{sensorType:u.type,sensorName:u.name,deviceId:u.deviceId,roomName:u.room,command:b,commandTopic:u.commandTopic,registrationDate:Date.now(),radius:f}).then((function(n){e.updateActions(n.data._id),B(!1),I({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),I({message:e.response.data.message,color:"red"})),B(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var Ot=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function ft(e){var n=Ot(),t=i.a.useState(!0),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(null),u=Object(r.a)(d,2),m=u[0],j=u[1];Object(c.useEffect)((function(){var e;e=j,BackgroundGeolocation.checkStatus((function(n){console.log("[INFO] BackgroundGeolocation service is running",n.isRunning),console.log("[INFO] BackgroundGeolocation services enabled",n.locationServicesEnabled),console.log("[INFO] BackgroundGeolocation auth status: "+n.authorization),1===n.authorization?e(!0):e(!1),console.log(n.authorization)}))}),[]);var g=function(){e.closeDialog(),l(!1)},b=null;return null!==m&&(m?b=Object(a.jsx)(xt,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:e.closeDialog}):(BackgroundGeolocation.removeAllListeners(),b=Object(a.jsxs)(Xe.a,{open:s,onClose:g,children:[Object(a.jsx)(Ye.a,{children:"Location-Based Action"}),Object(a.jsx)(gn.a,{dividers:!0,children:"When prompted, you must accept all asked permissions in order for the location services of this app to work. Otherwise this feature will remain disabled."}),Object(a.jsx)(jn.a,{children:Object(a.jsx)(p.a,{variant:"contained",onClick:function(){mt(j),g()},color:"primary",children:"Enable Location Services"})})]}))),Object(a.jsx)("div",{className:n.root,children:b})}var vt=Object(v.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},action:{margin:e.spacing(2),backgroundColor:e.palette.primary.main}}}));function yt(e){var n=vt(),t=i.a.useState(!1),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(null),d=Object(r.a)(l,2),u=d[0],p=d[1],m=function(){p(null)},j=null;switch(u){case"timerAction":j=Object(a.jsx)(at,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:m});break;case"sensorBasedAction":j=Object(a.jsx)(dt,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:m});break;case"locationBasedAction":j=Object(a.jsx)(ft,{closeDialog:m,sensors:e.sensors,updateActions:e.updateActions})}return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(An.a,{ariaLabel:"SpeedDial openIcon",className:n.speedDial,icon:Object(a.jsx)(Ln.a,{openIcon:Object(a.jsx)(pt.a,{})}),onClose:function(){s(!1)},onOpen:function(){s(!0)},open:o,children:[Object(a.jsx)(Fn.a,{className:n.action,icon:Object(a.jsx)(Te.a,{}),tooltipTitle:"Sensor Based",onClick:function(){p("sensorBasedAction")}}),Object(a.jsx)(Fn.a,{className:n.action,icon:Object(a.jsx)(Gn.a,{}),tooltipTitle:"Location Based",onClick:function(){p("locationBasedAction")}}),Object(a.jsx)(Fn.a,{className:n.action,icon:Object(a.jsx)(Mn.a,{}),tooltipTitle:"Time Based",onClick:function(){p("timerAction")}}),j]})})}var Ct=w+"api/actions",Nt=Object(v.a)((function(e){return{root:{margin:e.spacing(1)}}}));function kt(e){var n=Nt(),t=Object(c.useState)({actions:[],isFetching:!1}),i=Object(r.a)(t,2),o=i[0],s=i[1],l=Object(c.useState)(null),d=Object(r.a)(l,2),u=d[0],p=d[1],m=function(e){p(e)};return Object(c.useEffect)((function(){return function(){var e=Object(H.a)(E.a.mark((function e(){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s({actions:[],isFetching:!0}),e.next=4,C.a.get(Ct);case 4:n=e.sent,s({actions:n.data,isFetching:!1}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),s({actions:[],isFetching:!1});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}()(),function(){console.log("unmounting actions")}}),[u]),Object(a.jsxs)("div",{className:n.root,children:[0!==o.actions.length?o.actions.map((function(e){return Object(a.jsx)("div",{className:n.root,children:Object(a.jsx)(Bn,{action:e,updateActions:m})},e._id)})):Object(a.jsx)(Ee,{displayItem:"Actions"}),Object(a.jsx)(yt,{sensors:e.sensors,updateActions:m})]})}var It=Object(v.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(1)},title:{flexGrow:1}}}));function St(e){var n=It(),t=i.a.useState({open:!1,dialogItems:null}),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(void 0),d=Object(r.a)(l,2),u=d[0],m=d[1];return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(le.a,{position:"static",children:Object(a.jsxs)(de.a,{variant:"dense",children:[Object(a.jsx)(p.a,{size:"small",onClick:e.showAllSensors,color:"inherit",children:"All"}),Object(a.jsx)(p.a,{size:"small",onClick:function(){s({open:!0,dialogItems:{contents:e.rooms,name:"Rooms",type:"room"}})},color:"inherit",children:"Rooms"}),Object(a.jsx)(p.a,{size:"small",onClick:function(){s({open:!0,dialogItems:{contents:e.categories,name:"Sensor Types",type:"sensor-type"}})},color:"inherit",children:"Types"})]})}),null!==o.dialogItems?Object(a.jsx)(on,{name:o.dialogItems.name,type:o.dialogItems.type,contents:o.dialogItems.contents,selectedValue:u,open:o.open,onClose:function(n){s({open:!1,dialogItems:null}),m(n),n&&e.selectItem({selected:n,type:o.dialogItems.type})}}):null]})}function wt(){return Object(a.jsxs)(f.a,{variant:"body2",color:"textPrimary",align:"center",children:["Copyright \xa9 ","Home Automation ",(new Date).getFullYear(),"."]})}var Tt=Object(v.a)((function(e){return{root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(F.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{backgroundColor:e.palette.secondary.main,zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:200,width:"calc(100% - ".concat(200,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1,paddingTop:5},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:200,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(oe.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.down("sm"),{width:e.spacing(0)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(1),display:"flex",overflow:"auto",flexDirection:"column",borderRadius:"10px",backgroundColor:e.palette.secondary.main},primaryAction:Object(oe.a)({borderRadius:"10px"},e.breakpoints.down("sm"),{display:"none"}),dashBoardLabel:{},currentTab:{textAlign:"center",marginTop:e.spacing(2)},hiMessage:{marginRight:e.spacing(2)},behindBackground:{backgroundImage:"url(".concat(S,"/static/media/home-automation4.cc5ee920.svg)"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:"100vw",height:"100vh"}}}));var Rt=Object(d.g)((function(e){var n=Tt(),t=i.a.useState(!1),c=Object(r.a)(t,2),o=c[0],s=c[1],d=i.a.useState({selected:"All",type:"all"}),u=Object(r.a)(d,2),j=u[0],h=u[1],x=function(){k(),e.history.push("/login")},O=function(){s(!1)},v=function(){h({selected:"All",type:"all"})},y={tab:"All",content:null};switch(j.type){case"room":y.tab="Room",y.content=j.selected;break;case"sensor-type":y.tab="Sensor Type",y.content=j.selected;break;case"actions":y.tab="Actions",y.content=null;break;default:y.tab="All",y.content=null}var C=Object(ie.a)(new Set(e.sensors.map((function(e){return e.room})))),N=Object(ie.a)(new Set(e.sensors.map((function(e){return e.type})))),I=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}();return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(le.a,{position:"absolute",className:Object(se.a)(n.appBar,o&&n.appBarShift),children:Object(a.jsxs)(de.a,{className:n.toolbar,children:[Object(a.jsx)(me.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){s(!0)},className:Object(se.a)(n.menuButton,o&&n.menuButtonHidden),children:Object(a.jsx)(be.a,{})}),Object(a.jsx)("div",{className:n.title,children:Object(a.jsx)(rn.a,{href:"/",component:l.b,to:"/",color:"primary",underline:"none",variant:"h5",children:Object(a.jsx)("img",{src:"".concat(S,"/static/media/home-automation.1ec2cf5b.svg"),alt:"",height:50})})}),Object(a.jsxs)(f.a,{variant:"body2",className:n.hiMessage,children:["Hi, ",I.name]}),Object(a.jsx)(p.a,{variant:"contained",className:n.primaryAction,onClick:x,color:"primary",children:"Log Out"})]})}),Object(a.jsxs)(re.a,{variant:"temporary",classes:{paper:Object(se.a)(n.drawerPaper,!o&&n.drawerPaperClose)},open:o,onClose:O,children:[Object(a.jsx)("div",{className:n.toolbarIcon,children:Object(a.jsx)(me.a,{onClick:O,children:Object(a.jsx)(xe.a,{})})}),Object(a.jsx)(pe.a,{}),Object(a.jsxs)(ue.a,{children:[Object(a.jsxs)(Oe.a,{button:!0,onClick:v,children:[Object(a.jsx)(fe.a,{children:Object(a.jsx)(_e.a,{color:"primary"})}),Object(a.jsx)(ve.a,{primary:"All"})]}),Object(a.jsx)(sn,{contents:C,selectItem:h,name:"Rooms",type:"room"}),Object(a.jsx)(sn,{contents:N,selectItem:h,name:"Sensor Types",type:"sensor-type"})]}),Object(a.jsx)(pe.a,{}),Object(a.jsxs)(ue.a,{children:[Object(a.jsxs)(Oe.a,{button:!0,onClick:function(){h({selected:"Actions",type:"actions"})},children:[Object(a.jsx)(fe.a,{children:Object(a.jsx)(Ve.a,{color:"primary"})}),Object(a.jsx)(ve.a,{primary:"Actions"})]}),Object(a.jsxs)(Oe.a,{button:!0,onClick:x,children:[Object(a.jsx)(fe.a,{children:Object(a.jsx)(Ke.a,{color:"primary"})}),Object(a.jsx)(ve.a,{primary:"Log Out"})]})]})]}),Object(a.jsx)("div",{className:n.behindBackground,children:Object(a.jsxs)("main",{className:n.content,children:[Object(a.jsx)("div",{className:n.appBarSpacer}),Object(a.jsx)(St,{selectItem:h,rooms:C,categories:N,showAllSensors:v}),Object(a.jsxs)("div",{className:n.currentTab,children:[Object(a.jsx)(f.a,{variant:"h5",gutterBottom:!0,className:n.dashBoardLabel,children:"Dashboard"}),Object(a.jsxs)(f.a,{variant:"h6",children:[y.tab,"All"===y.tab||"Actions"===y.tab?null:" | ",y.content]})]}),Object(a.jsxs)(je.a,{maxWidth:"lg",className:n.container,children:["Actions"===j.selected?Object(a.jsx)("div",{children:Object(a.jsx)(g.a,{className:n.paper,elevation:10,children:Object(a.jsx)(kt,{sensors:e.sensors})})}):Object(a.jsx)(He,{sensors:e.sensors,filtered:j.type,selected:j.selected}),Object(a.jsx)(b.a,{pt:4,children:Object(a.jsx)(wt,{})})]})]})})]})})),Bt=w+"api/activeSensors",At=function(){var e=Object(c.useState)({sensors:[]}),n=Object(r.a)(e,2),t=n[0],i=n[1],o=Object(c.useRef)(t);return Object(c.useEffect)((function(){(function(){var n=Object(H.a)(E.a.mark((function n(){var t,a,c,s;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C.a.get(Bt);case 3:t=n.sent,i({sensors:t.data}),o.current={sensors:t.data},a=Object(P.a)(t.data);try{for(a.s();!(c=a.n()).done;)s=c.value,K.subscribe(e,s.pubTopic)}catch(r){a.e(r)}finally{a.f()}n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0),i({sensors:[]});case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}})()();var e=K.getClient();console.log(e);var n=function(n,t,a){if(console.log(t.toString(),n),"browser"!==n);else{var c=JSON.parse(t.toString());if("disconnected"===c.action){var s={sensors:o.current.sensors.filter((function(n){return n.deviceId===c.deviceId&&K.unsubscribe(e,n.pubTopic),n.deviceId!==c.deviceId})),alertMessage:{device:c.deviceId,reason:c.action}};o.current=s,i(s)}else if("connected"===c.action){if(o.current.sensors.find((function(e){return e.deviceId===c.newSensors[0].deviceId})))return void console.log("Exists!!! No action taken!");var r,l={sensors:o.current.sensors.concat(c.newSensors),alertMessage:{device:c.newSensors[0].deviceId,reason:c.action}},d=Object(P.a)(c.newSensors);try{for(d.s();!(r=d.n()).done;){var u=r.value;K.subscribe(e,u.pubTopic)}}catch(m){d.e(m)}finally{d.f()}o.current=l,i(l)}else if("action"===c.action){console.log(c);var p={sensors:o.current.sensors,alertMessage:{reason:c.action,actionCategory:c.actionInfo.actionCategory,command:c.actionInfo.command,roomName:c.actionInfo.roomName,sensorType:c.actionInfo.sensorType}};o.current=p,i(p)}}};return e.on("message",n),function(){console.log("Dashboard was unmounted!"),e.off("message",n)}}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)(ce,{alertMessage:t.alertMessage}),Object(a.jsx)(Rt,{sensors:t.sensors,alertMessage:t.alertMessage})]})};t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p;var Lt=function(){var e=Object(c.useState)(!0),n=Object(r.a)(e,2),t=n[0],i=n[1];return Object(c.useEffect)((function(){var e=N();e&&C.a.get("http://localhost:5000/api/verifyToken?token=".concat(e)).then((function(e){I(e.data.token,e.data.user),i(!1)})).catch((function(e){alert(e),k(),i(!1)}))}),[]),t&&N()?Object(a.jsx)("div",{className:"content",children:"Checking Authentication..."}):Object(a.jsx)(l.a,{children:Object(a.jsxs)(d.d,{children:[Object(a.jsx)(M,{path:"/dashboard",component:At}),Object(a.jsx)(G,{path:"/",component:A})]})})},Ft=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,404)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),i(e),o(e)}))},Dt=t(386),Mt=t(206),zt=Object(Mt.a)({palette:{background:{default:"#FFF",emphasis:"#E8EAF6",secondary:"#C5CAE9",header:"#121037"},text:{primary:"#615f5d",secondary:"#999693",hint:"#ccc8c4",whiteText:"white"},primary:{main:"#000000",light:"#333333",dark:"#545454"},secondary:{main:"#b09058",light:"#deb66f",dark:"#9c7f4e"},contrastThreshold:1.8}}),Gt=function(){s.a.render(Object(a.jsxs)(Dt.a,{theme:zt,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(Lt,{})]}),document.getElementById("root"))};window.cordova?document.addEventListener("deviceready",(function(){Gt()}),!1):Gt(),Ft()}},[[317,1,2]]]);
//# sourceMappingURL=main.623591df.chunk.js.map