(this["webpackJsonpio.cordova.hellocordova"]=this["webpackJsonpio.cordova.hellocordova"]||[]).push([[0],{234:function(e,n,t){},235:function(e,n,t){},266:function(e,n){},268:function(e,n){},303:function(e,n){},304:function(e,n){},306:function(e,n){},308:function(e,n){},317:function(e,n,t){"use strict";t.r(n);var a=t(1),c=t(0),o=t.n(c),i=t(13),s=t.n(i),r=(t(234),t(7)),l=(t(235),t(66)),d=t(22),u=t(393),j=t(128),m=t(364),p=t(394),g=t(142),b=t(387),h=t(363),x=t(187),O=t.n(x),f=t(52),v=t(63),y=t(28),C=t.n(y),N=function(){return sessionStorage.getItem("token")||null},k=function(){sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},I=function(e,n){sessionStorage.setItem("token",e),sessionStorage.setItem("user",JSON.stringify(n))},S="";document.addEventListener("deviceready",(function(){S="".concat(window.cordova.file.applicationDirectory,"www")}),!1);var w="http://192.168.1.66:5000/",T="http://192.168.1.66:8883";function R(){return Object(a.jsxs)(f.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ","Home Automation ",(new Date).getFullYear(),"."]})}var B=Object(v.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(S,"/static/media/home-automation3.2481b425.svg)"),backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function A(e){var n=B(),t=D(""),o=D(""),i=Object(c.useState)(null),s=Object(r.a)(i,2),l=s[0],d=s[1],x=Object(c.useState)(!1),v=Object(r.a)(x,2),y=(v[0],v[1]);return Object(a.jsxs)(h.a,{container:!0,component:"main",className:n.root,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(h.a,{item:!0,xs:!1,sm:4,md:7,className:n.image}),Object(a.jsx)(h.a,{item:!0,xs:12,sm:8,md:5,component:g.a,elevation:6,square:!0,children:Object(a.jsxs)("div",{className:n.paper,children:[Object(a.jsx)(u.a,{className:n.avatar,children:Object(a.jsx)(O.a,{})}),Object(a.jsx)(f.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:n.form,noValidate:!0,children:[Object(a.jsx)(p.a,{variant:"filled",color:"secondary",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,onChange:t.onChange}),Object(a.jsx)(p.a,{variant:"filled",color:"secondary",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:o.onChange}),l&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:"red"},children:l}),Object(a.jsx)("br",{})]}),Object(a.jsx)(j.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,onClick:function(){d(null),y(!0),C.a.post(w+"api/users/signin",{username:t.value,password:o.value}).then((function(n){y(!1),I(n.data.token,n.data.user),e.history.push("/dashboard")})).catch((function(e){console.log(e),console.log(e.response),alert(e),y(!1),e.response?401!==e.response.status&&400!==e.response.status||d(e.response.data.message):d("Something went wrong. Please try again later.")}))},children:"Sign In"}),Object(a.jsx)(b.a,{mt:5,children:Object(a.jsx)(R,{})})]})]})})]})}var D=function(e){var n=Object(c.useState)(e),t=Object(r.a)(n,2),a=t[0],o=t[1];return{value:a,onChange:function(e){o(e.target.value)}}},L=t(48),F=t(126);var z=function(e){var n=e.component,t=Object(F.a)(e,["component"]);return Object(a.jsx)(d.b,Object(L.a)(Object(L.a)({},t),{},{render:function(e){return N()?Object(a.jsx)(n,Object(L.a)({},e)):Object(a.jsx)(d.a,{to:{pathname:"/",state:{from:e.location}}})}}))};var M,G=function(e){var n=e.component,t=Object(F.a)(e,["component"]);return Object(a.jsx)(d.b,Object(L.a)(Object(L.a)({},t),{},{render:function(e){return N()?Object(a.jsx)(d.a,{to:{pathname:"/dashboard"}}):Object(a.jsx)(n,Object(L.a)({},e))}}))},W=t(62),P=t.n(W),E=t(107),H=t(96),q=t(188),_=t.n(q),U=T,V="mqttjs_brower_"+Math.random().toString(16).substr(2,4),J={keepalive:30,clientId:V,protocolId:"MQTT",protocolVersion:4,clean:!0,reconnectPeriod:1e3,connectTimeout:3e4,will:{topic:"WillMsg",payload:"Connection Closed abnormally..!",qos:0,retain:!1},rejectUnauthorized:!1},K={getClient:function(){return M||((M=_.a.connect(U,J)).subscribe("browser"),M.on("error",(function(e){console.log("Connection to ".concat(U," failed"),e),M.end()})),M.on("close",(function(){console.log(V+" disconnected")}))),M},publishMessage:function(e,n,t){e.publish(n,t)},subscribe:function(e,n){return e.subscribe(n,(function(e,n){e&&console.log("Subscription request failed")}))},onMessage:function(e,n){e.on("message",(function(t,a,c){console.log(a.toString(),t),n(e,t,a)}))},unsubscribe:function(e,n){e.unsubscribe(n)},closeConnection:function(e){e.end(),e=void 0},extractMqttTopicInfo:function(e){var n=e.split("/"),t=Object(r.a)(n,4);return{room:t[0],deviceId:t[1],type:t[2],sensorName:t[3]}}},Q=t(389),Y=t(390);function X(e){return Object(a.jsx)(Q.a,Object(L.a)({elevation:6,variant:"filled"},e))}var Z=Object(v.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function $(e){var n,t,o,i=Z(),s=Object(c.useState)(!!e.alertMessage),l=Object(r.a)(s,2),d=l[0],u=l[1],j=function(e,n){"clickaway"!==n&&u(!1)};return Object(c.useEffect)((function(){u(!!e.alertMessage)}),[e]),e.alertMessage&&(n=e.alertMessage.device,t=e.alertMessage.reason),"connected"===t?o="success":"disconnected"===t?o="error":"action"===t&&(o="info"),Object(a.jsx)("div",{className:i.root,children:Object(a.jsx)(Y.a,{open:d,onClose:j,autoHideDuration:6e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:Object(a.jsx)(X,{severity:o,onClose:j,children:"action"===t?"".concat(e.alertMessage.actionCategory," triggered! Sending command [").concat(e.alertMessage.command,"] on ").concat(e.alertMessage.sensorName," | ").concat(e.alertMessage.roomName):"".concat(n," was ").concat(t)})})})}var ee=t(141),ne=t(61),te=t(4),ae=t(396),ce=t(383),oe=t(381),ie=t(369),se=t(378),re=t(210),le=t(385),de=t(200),ue=t.n(de),je=t(201),me=t.n(je),pe=t(323),ge=t(374),be=t(373),he=t(401),xe=t(370),Oe=t(46),fe=t.n(Oe),ve=t(37),ye=t.n(ve),Ce=t(38),Ne=t.n(Ce),ke=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},imageLightOpen:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/lightbulb-open2.d67991f2.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},imageLightClosed:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/lightbulb-closed2.909d2ca0.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},currentState:{display:"flex",alignItems:"center",padding:e.spacing(1)},onOff:{marginLeft:e.spacing(1),padding:e.spacing(1),color:e.palette.secondary.main,borderStyle:"dashed",borderColor:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},circularProgress:{display:"inline","& > * + *":{marginLeft:e.spacing(2)}}}}));function Ie(e){var n=ke(),t=Object(c.useState)("Loading..."),o=Object(r.a)(t,2),i=o[0],s=o[1],l="ON"===i,d=Object(c.useState)({spinner:!1,disabled:!0}),u=Object(r.a)(d,2),j=u[0],m=u[1];return Object(c.useEffect)((function(){var n=K.getClient(),t=function(n,t,a){console.log(t.toString(),n),n===e.topic&&(s(t.toString()),m({spinner:!1,disabled:!1}))};return n.on("message",t),function(){console.log("unmounting relay"),n.off("message",t)}}),[e.topic]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:["ON"===i?Object(a.jsx)("div",{className:n.imageLightOpen}):Object(a.jsx)("div",{className:n.imageLightClosed}),Object(a.jsxs)("div",{className:n.currentState,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Current state "}),Object(a.jsx)(f.a,{className:n.onOff,variant:"subtitle2",children:i})]}),!0===j.spinner?Object(a.jsx)("div",{className:n.circularProgress,children:Object(a.jsx)(xe.a,{})}):null,Object(a.jsx)(he.a,{onChange:function(n){var t=K.getClient();console.log(t,e.command),n.target.checked?K.publishMessage(t,e.command,"ON"):K.publishMessage(t,e.command,"OFF"),m({spinner:!0,disabled:!0})},checked:l,disabled:j.disabled})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(ye.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Ne.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.name})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(fe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var Se=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},progressBar:{textAlign:"center",width:"100%"},brightnessIcon:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/brightness.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:30,height:30},degrees:{textAlign:"center",backgroundColor:e.palette.secondary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"}}}));function we(e){var n=Se(),t=e.value;return e.value>100&&(t=100),Object(a.jsxs)(b.a,{position:"relative",display:"inline-flex",children:[Object(a.jsx)(xe.a,{variant:"determinate",value:t,size:100}),Object(a.jsx)(b.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)("div",{className:n.brightnessIcon}),Object(a.jsx)(f.a,{variant:"body2",component:"div",color:"textSecondary",children:"".concat(Math.round(t),"%")})]})})]})}function Te(e){var n=Se(),t=Object(c.useState)({brightness:"Loading...",percentage:0}),i=Object(r.a)(t,2),s=i[0],l=i[1];return o.a.useEffect((function(){var n=K.getClient(),t=function(n,t,a){if(console.log(t.toString(),n),n===e.topic){var c=t.toString(),o=parseFloat(c);l({brightness:c,percentage:o})}};return n.on("message",t),function(){console.log("unmounting light intensity"),n.off("message",t)}}),[e.topic]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)("div",{className:n.progressBar,children:Object(a.jsx)(we,{value:s.percentage})}),Object(a.jsx)(f.a,{className:n.degrees,children:"".concat(s.brightness," lux")})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(ye.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Ne.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(fe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var Re=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},degrees:{textAlign:"center",backgroundColor:e.palette.secondary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"},imageTemperature:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/thermometer.26bec6cd.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},imageHumidity:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/humidity.41d15f93.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},imageAverage:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/average.9152ffbf.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(1)},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},tempHum:{display:"flex",flexWrap:"wrap",justifyContent:"center"},averageMeasurementsDiv:{display:"flex",alignItems:"center",flexDirection:"column",backgroundColor:e.palette.secondary.main,padding:e.spacing(1),borderRadius:"10px",margin:e.spacing(1),color:"white"}}}));function Be(e){var n=Re(),t=Object(c.useState)({avgTemp:null,avgHum:null,isFetching:!1}),o=Object(r.a)(t,2),i=o[0],s=o[1],l=Object(c.useState)({temperature:"Loading...",humidity:"Loading..."}),d=Object(r.a)(l,2),u=d[0],j=d[1],m="No Samples yet";return null!==i.avgTemp&&(m="".concat(Math.round(i.avgTemp),"\xb0C /\n    ").concat(Math.round(i.avgHum),"%")),Object(c.useEffect)((function(){(function(){var n=Object(H.a)(P.a.mark((function n(){var t,a,c,o,i,r,l;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s({avgTemp:null,avgHum:null,isFetching:!0}),n.next=4,C.a.get("".concat(w,"api/measurements/").concat(e.sensorName));case 4:t=n.sent,a=0,c=0,o=0,i=Object(E.a)(t.data);try{for(i.s();!(r=i.n()).done;)l=r.value,a+=l.temperaturesSum,c+=l.humiditiesSum,o+=l.measurementsCounter}catch(d){i.e(d)}finally{i.f()}console.log(t.data),0!==t.data.length&&s({avgTemp:a/=o,avgHum:c/=o,isFetching:!1}),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),console.log(n.t0),s({avgTemp:null,avgHum:null,isFetching:!1});case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(){return n.apply(this,arguments)}})()();var n=K.getClient(),t=function(n,t,a){if(console.log(t.toString(),n),n===e.topic){var c=t.toString().split("-");j({temperature:c[0],humidity:c[1]})}};return n.on("message",t),function(){console.log("unmounting temp-hum"),n.off("message",t)}}),[e.topic,e.sensorName]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.averageMeasurementsDiv,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Average"}),Object(a.jsx)("div",{className:n.imageAverage}),Object(a.jsx)(f.a,{className:n.degrees,children:m})]}),Object(a.jsxs)("div",{className:n.tempHum,children:[Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Temperature"}),Object(a.jsx)("div",{className:n.imageTemperature}),Object(a.jsxs)(f.a,{className:n.degrees,children:["".concat(u.temperature," \xb0C"),Object(a.jsx)("br",{})]})]}),Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Humidity"}),Object(a.jsx)("div",{className:n.imageHumidity}),Object(a.jsxs)(f.a,{className:n.degrees,children:[u.humidity," %",Object(a.jsx)("br",{})]})]})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(ye.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Ne.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(fe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var Ae="Lightbulb",De="Temperature-Humidity",Le="Light-Intensity",Fe=function(e,n){switch(e){case Ae:switch(n){case"ON":return{command:"ON",description:"Turn the lights on"};case"OFF":return{command:"OFF",description:"Turn the lights off"};default:return[{command:"ON",description:"Turn the lights on"},{command:"OFF",description:"Turn the lights off"}]}}},ze=function(e){switch(e){case"Temperature (Celcius)":return"Celcius";case"Humidity (%)":case"Light Intensity (%)":return"%"}},Me=Object(v.a)((function(e){return{paper:{padding:e.spacing(1),display:"flex",overflow:"auto",flexDirection:"column",backgroundColor:e.palette.secondary.main,borderRadius:"10px"},title:{backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),textAlign:"center"},roomTitle:{textAlign:"center",backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),margin:e.spacing(1)}}}));function Ge(e){var n=Me();return e.sensor.type===Le?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Room brightness"}),Object(a.jsx)(Te,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===De?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Temperature & Humidity"}),Object(a.jsx)(Be,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===Ae?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Lights"}),Object(a.jsx)(Ie,{roomName:e.sensor.room,device:e.sensor.deviceId,name:e.sensor.name,command:e.sensor.commandTopic,topic:e.sensor.pubTopic})]})}):null}var We=Object(v.a)((function(e){return{image:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/not-found.cd5a9b2a.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:"80vh",height:"50vh"},divNoContent:{margin:e.spacing(1),display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},title:{margin:e.spacing(1),padding:e.spacing(1),color:"white",textAlign:"center"}}}));function Pe(e){var n=We();return Object(a.jsxs)("div",{className:n.divNoContent,children:[Object(a.jsx)(f.a,{variant:"h3",component:"h3",gutterBottom:!0,className:n.title,children:e.displayItem?"No ".concat(e.displayItem," Found"):"Nothing Found"}),Object(a.jsx)("div",{className:n.image})]})}var Ee=Object(v.a)((function(e){return{paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",backgroundColor:e.palette.secondary.main}}}));function He(e){var n=Ee(),t=e.sensors;return"room"===e.filtered?t=e.sensors.filter((function(n){return n.room===e.selected})):"sensor-type"===e.filtered&&(t=e.sensors.filter((function(n){return n.type===e.selected}))),0===t.length?Object(a.jsx)(g.a,{className:n.paper,elevation:10,children:Object(a.jsx)(Pe,{displayItem:"Devices"})}):Object(a.jsx)(h.a,{container:!0,spacing:3,justify:"center",children:t.map((function(e){return Object(a.jsx)(Ge,{sensor:e},e.name)}))})}var qe=t(202),_e=t.n(qe),Ue=t(203),Ve=t.n(Ue),Je=t(204),Ke=t.n(Je),Qe=t(372),Ye=t(371),Xe=t(321),Ze=t(189),$e=t.n(Ze),en=t(190),nn=t.n(en),tn=t(191),an=t.n(tn),cn=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},dialogPaper:{},emptyContentLabel:{margin:36}}}));function on(e){var n=cn(),t=e.onClose,c=e.open;return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{classes:{paper:n.dialogPaper},onClose:function(){t(void 0)},"aria-labelledby":"simple-dialog-title",open:c,children:[Object(a.jsx)(Ye.a,{id:"simple-dialog-title",children:e.name}),0!==e.contents.length?Object(a.jsx)(ie.a,{children:e.contents.map((function(c){return Object(a.jsxs)(pe.a,{button:!0,onClick:function(){t(c)},children:[Object(a.jsx)(Qe.a,{children:Object(a.jsx)(u.a,{className:n.avatar,children:"room"===e.type?Object(a.jsx)($e.a,{}):Object(a.jsx)(nn.a,{})})}),Object(a.jsx)(be.a,{primary:c})]},c)}))}):Object(a.jsxs)(f.a,{variant:"body1",color:"secondary",align:"center",className:n.emptyContentLabel,children:["No ",e.name," found."]})]})})}function sn(e){var n=o.a.useState(!1),t=Object(r.a)(n,2),c=t[0],i=t[1],s=o.a.useState(void 0),l=Object(r.a)(s,2),d=l[0],u=l[1];return Object(a.jsxs)("div",{children:[Object(a.jsxs)(pe.a,{button:!0,onClick:function(){i(!0)},children:[Object(a.jsx)(ge.a,{children:"room"===e.type?Object(a.jsx)(ye.a,{color:"primary"}):Object(a.jsx)(an.a,{color:"primary"})}),Object(a.jsx)(be.a,{primary:e.name})]}),Object(a.jsx)(on,{name:e.name,type:e.type,contents:e.contents,selectedValue:d,open:c,onClose:function(n){i(!1),u(n),n&&e.selectItem({selected:n,type:e.type})}})]})}var rn=t(384),ln=t(391),dn=t(377),un=t(376),jn=t(195),mn=t.n(jn),pn=t(325),gn=t(324),bn=t(375),hn=t(192),xn=t.n(hn);function On(e){var n=o.a.useState(!1),t=Object(r.a)(n,2),i=t[0],s=t[1],l=Object(c.useState)(null),d=Object(r.a)(l,2),u=d[0],m=d[1],p=function(){s(!1),m(null)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(re.a,{onClick:function(){s(!0)},color:"primary",children:Object(a.jsx)(xn.a,{})}),Object(a.jsxs)(Xe.a,{open:i,onClose:p,"aria-labelledby":"responsive-dialog-title",children:[Object(a.jsx)(Ye.a,{id:"responsive-dialog-title",children:"Warning"}),Object(a.jsxs)(gn.a,{children:[Object(a.jsx)(bn.a,{children:"Are you sure you want to delete this action?"}),u&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:"red"},children:u}),Object(a.jsx)("br",{})]})]}),Object(a.jsxs)(pn.a,{children:[Object(a.jsx)(j.a,{variant:"contained",autoFocus:!0,onClick:p,color:"primary",children:"Cancel"}),Object(a.jsx)(j.a,{variant:"contained",autoFocus:!0,onClick:function(){m(null),C.a.delete("".concat(w,"api/actions/").concat(e.action._id),{data:e.action._id}).then((function(n){e.updateActions(e.action._id.toString()+Math.random().toString(16).substr(2,8)),s(!1)})).catch((function(e){console.log(e.response),e.response?404===e.response.status&&m(e.response.data.message):m("Something went wrong. Please try again later.")}))},color:"primary",children:"Delete"})]})]})]})}var fn=t(193),vn=t.n(fn),yn=t(194),Cn=t.n(yn),Nn=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},timeInfoIndividual:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1)},dateLabel:{marginLeft:e.spacing(1)}}}));function kn(e){var n=Nn();return Object(a.jsxs)("div",{className:n.accordionContent,children:[Object(a.jsxs)("div",{className:n.timeInfoIndividual,children:[Object(a.jsx)(vn.a,{}),Object(a.jsx)(f.a,{className:n.dateLabel,variant:"subtitle1",children:"Starting time: ".concat(e.date.toLocaleString())})]}),Object(a.jsxs)("div",{className:n.timeInfoIndividual,children:[Object(a.jsx)(Cn.a,{}),Object(a.jsx)(f.a,{className:n.dateLabel,variant:"subtitle1",children:e.recurrenceMessage})]})]})}var In=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},whenDescription:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),flexWrap:"wrap"},whenSensorDescription:{borderRadius:"10px",backgroundColor:"white",display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),flexWrap:"wrap"},labelDynamicContent:{marginLeft:e.spacing(1),marginRight:e.spacing(1),backgroundColor:e.palette.primary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),borderRadius:"10px"},deviceInfoIndividual:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},deviceInfo:Object(ne.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},e.breakpoints.down("md"),{marginTop:e.spacing(2)})}}));function Sn(e){var n=In();return Object(a.jsxs)("div",{className:n.accordionContent,children:[Object(a.jsxs)("div",{className:n.whenDescription,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"When ".concat(e.measurementType.toLowerCase()," is ").concat(e.comparisonType.toLowerCase()," ")}),Object(a.jsx)(f.a,{className:n.labelDynamicContent,variant:"subtitle1",children:"".concat(e.quantity," ")}),Object(a.jsx)(f.a,{variant:"subtitle1",children:"".concat(ze(e.measurementType),".")})]}),Object(a.jsxs)("div",{className:n.whenSensorDescription,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(ye.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementRoomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Ne.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementSensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(fe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementDeviceId})]})]})]})}var wn=Object(v.a)((function(e){return{root:{width:"100%"},command:{color:e.palette.primary.main,fontSize:e.typography.pxToRem(15),padding:e.spacing(1),margin:e.spacing(1),flexShrink:0,borderStyle:"solid",borderColor:e.palette.primary.main,borderRadius:"10px",backgroundColor:e.palette.secondary.main},headingCommand:{borderColor:e.palette.secondary.main,borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center"},heading:{margin:e.spacing(1),flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary,padding:e.spacing(1),margin:e.spacing(1)},summary:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-start"},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},deviceInfo:Object(ne.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},e.breakpoints.down("md"),{marginTop:e.spacing(2)}),deleteButton:{display:"flex",justifyContent:"center"}}}));function Tn(e){var n=wn(),t=o.a.useState(!1),c=Object(r.a)(t,2),i=c[0],s=c[1],l=null;switch(e.action.actionCategory){case"Timer Action":var d,u;u=e.action.recurrenceNumber?"Every ".concat(e.action.recurrenceNumber," ").concat(e.action.recurrenceTimeUnit):"None",d=new Date(e.action.startTime),l=Object(a.jsx)(kn,{recurrenceMessage:u,date:d});break;case"Sensor-Based Action":l=Object(a.jsx)(Sn,{measurementType:e.action.measurementType,quantity:e.action.quantity,comparisonType:e.action.comparisonType,measurementSensorName:e.action.measurementSensorName,measurementDeviceId:e.action.measurementDeviceId,measurementRoomName:e.action.measurementRoomName})}var j,m=Fe(e.action.sensorType,e.action.command),p=new Date(e.action.registrationDate);return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(ln.a,{expanded:"panel1"===i,onChange:(j="panel1",function(e,n){s(!!n&&j)}),children:[Object(a.jsx)(un.a,{expandIcon:Object(a.jsx)(mn.a,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:Object(a.jsxs)("div",{className:n.summary,children:[Object(a.jsxs)("div",{className:n.headingCommand,children:[Object(a.jsx)(f.a,{variant:"subtitle1",className:n.heading,children:e.action.actionCategory}),Object(a.jsx)(f.a,{className:n.command,children:m.description})]}),Object(a.jsxs)("div",{className:n.deviceInfo,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(ye.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Ne.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(fe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.deviceId})]})]}),Object(a.jsxs)(f.a,{className:n.secondaryHeading,children:["Registered on: ",p.toLocaleString()]})]})}),Object(a.jsx)(dn.a,{children:l}),Object(a.jsx)(se.a,{}),Object(a.jsx)("div",{className:n.deleteButton,children:Object(a.jsx)(On,{action:e.action,updateActions:e.updateActions})})]})})}var Rn=t(399),Bn=t(400),An=t(392),Dn=t(199),Ln=t.n(Dn),Fn=t(198),zn=t.n(Fn),Mn=t(205),Gn=t(23),Wn=t(380),Pn=t(402),En=t(398),Hn=t(379),qn=t(367),_n=t(388),Un=Object(v.a)((function(e){return{button:{display:"block",marginTop:e.spacing(2)},formControl:{minWidth:120,maxWidth:250},menuItem:{padding:e.spacing(1),display:"flex"}}}));function Vn(e){var n=Un(),t=o.a.useState(""),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(!1),d=Object(r.a)(l,2),u=d[0],j=d[1],m=null;return e.sensors&&(void 0===e.isCommandSensor?m=e.sensors:e.isCommandSensor?m=e.sensors.filter((function(e){return e.commandTopic})):e.isCommandSensor||(m=e.sensors.filter((function(e){return!e.commandTopic})))),Object(a.jsx)("div",{children:Object(a.jsxs)(qn.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(En.a,{id:"demo-controlled-open-select-label",children:"Sensor"}),Object(a.jsxs)(_n.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){j(!1)},onOpen:function(){j(!0)},value:i,onChange:function(n){s(n.target.value),e.selectSensor(n.target.value)},children:[Object(a.jsx)(Hn.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),m?m.map((function(e){return Object(a.jsxs)(Hn.a,{value:e,children:[Object(a.jsx)(Ne.a,{}),"  ",e.name,"  ",Object(a.jsx)(ye.a,{}),"  ",e.room,"  ",Object(a.jsx)(fe.a,{}),"  ",e.deviceId]},e.name)})):null]})]})})}var Jn=Object(v.a)((function(e){return{formControl:{minWidth:120},menuItem:{padding:e.spacing(1)}}}));function Kn(e){var n=Jn(),t=o.a.useState(""),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(!1),d=Object(r.a)(l,2),u=d[0],j=d[1],m=Fe(e.type);return Object(a.jsx)("div",{children:Object(a.jsxs)(qn.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(En.a,{id:"demo-controlled-open-select-label",children:"Command"}),Object(a.jsx)(_n.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){j(!1)},onOpen:function(){j(!0)},value:i,onChange:function(n){s(n.target.value),e.selectCommand(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(Hn.a,{value:e.command,children:e.description},n)})):null})]})})}var Qn=t(5),Yn=t(213),Xn=Object(Qn.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(Yn.a),Zn=Object(v.a)((function(e){return{margin:{margin:e.spacing(1)}}}));function $n(e){var n=Zn(),t=o.a.useState(""),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(""),d=Object(r.a)(l,2),u=d[0],j=d[1];console.log(i);return Object(a.jsxs)("div",{children:[Object(a.jsxs)(qn.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(En.a,{htmlFor:"demo-customized-textbox",children:"Recurrence every"}),Object(a.jsx)(Xn,{type:"number",id:"demo-customized-textbox",value:i,onChange:function(n){s(n.target.value),e.selectRecurrence(n.target.value)}})]}),Object(a.jsxs)(qn.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(En.a,{id:"demo-customized-select-label",children:"Units"}),Object(a.jsxs)(_n.a,{labelId:"demo-customized-select-label",id:"demo-customized-select",value:u,onChange:function(n){j(n.target.value),e.selectTimeUnits(n.target.value)},input:Object(a.jsx)(Xn,{}),children:[Object(a.jsx)(Hn.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),Object(a.jsx)(Hn.a,{value:"Minutes",children:"Minutes"}),Object(a.jsx)(Hn.a,{value:"Hours",children:"Hours"}),Object(a.jsx)(Hn.a,{value:"Days",children:"Days"})]})]})]})}var et=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},extendedIcon:{marginRight:e.spacing(1)},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(4)},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)}}}));function nt(e){var n=et(),t=o.a.useState(!0),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(new Date),d=Object(r.a)(l,2),u=d[0],m=d[1],p=o.a.useState(""),g=Object(r.a)(p,2),b=g[0],h=g[1],x=o.a.useState(""),O=Object(r.a)(x,2),f=O[0],v=O[1],y=o.a.useState(""),N=Object(r.a)(y,2),k=N[0],I=N[1],S=o.a.useState(""),T=Object(r.a)(S,2),R=T[0],B=T[1],A=o.a.useState({message:null,color:null}),D=Object(r.a)(A,2),L=D[0],F=D[1],z=o.a.useState(!1),M=Object(r.a)(z,2),G=M[0],W=M[1],P=function(e){m(e)},E=function(){e.closeDialog(),s(!1),F({message:null,color:null}),h(""),v(""),I(""),B(""),m(new Date)};return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:i,onClose:E,children:[Object(a.jsx)(Ye.a,{children:"Schedule an action"}),Object(a.jsxs)(gn.a,{dividers:!0,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Vn,{sensors:e.sensors,isCommandSensor:!0,selectSensor:h})}),""===b?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Kn,{type:b.type,selectCommand:v})}),Object(a.jsxs)(Gn.a,{utils:Mn.a,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Wn.a,{margin:"normal",id:"date-picker-dialog",label:"Starting Date Picker",format:"MM/dd/yyyy",value:u,onChange:P,KeyboardButtonProps:{"aria-label":"change date"}})}),Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Pn.a,{margin:"normal",id:"time-picker",label:"Starting Time Picker",value:u,onChange:P,KeyboardButtonProps:{"aria-label":"change time"}})})]}),Object(a.jsx)($n,{selectRecurrence:I,selectTimeUnits:B}),L.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:L.color},children:L.message}),Object(a.jsx)("br",{})]})]}),Object(a.jsx)(pn.a,{children:!0===G?Object(a.jsx)(xe.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(j.a,{className:n.cancelButton,variant:"contained",onClick:E,color:"primary",children:"Cancel"}),Object(a.jsx)(j.a,{variant:"contained",onClick:function(){F({message:null,color:null}),W(!0),C.a.post(w+"api/timerActions",{sensorType:b.type,sensorName:b.name,deviceId:b.deviceId,roomName:b.room,command:f,commandTopic:b.commandTopic,registrationDate:Date.now(),timestamp:u,recurrenceTimeUnit:R,recurrenceNumber:k}).then((function(n){e.updateActions(n.data._id),W(!1),F({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),F({message:e.response.data.message,color:"red"})),W(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var tt=Object(Qn.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:14,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(Yn.a),at=Object(v.a)((function(e){return{margin:{margin:e.spacing(1)}}}));function ct(e){var n=at(),t=o.a.useState(""),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(""),d=Object(r.a)(l,2),u=d[0],j=d[1];return Object(a.jsxs)("div",{children:[Object(a.jsxs)(qn.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(En.a,{required:!0,id:"demo-customized-select-label",children:"Compare"}),Object(a.jsxs)(_n.a,{labelId:"demo-customized-select-label",id:"demo-customized-select",value:u,onChange:function(n){j(n.target.value),e.selectComparison(n.target.value)},input:Object(a.jsx)(tt,{}),children:[Object(a.jsx)(Hn.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),Object(a.jsx)(Hn.a,{value:"Below",children:"Below"}),Object(a.jsx)(Hn.a,{value:"Over",children:"Over"}),Object(a.jsx)(Hn.a,{value:"Equal To",children:"Equal To"})]})]}),Object(a.jsxs)(qn.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(En.a,{required:!0,htmlFor:"demo-customized-textbox",children:"Quantity"}),Object(a.jsx)(tt,{type:"number",id:"demo-customized-textbox",value:i,onChange:function(n){s(n.target.value),e.selectQuantity(n.target.value)}})]})]})}var ot=Object(v.a)((function(e){return{formControl:{minWidth:130},menuItem:{padding:e.spacing(1)}}}));function it(e){var n=ot(),t=o.a.useState(""),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(!1),d=Object(r.a)(l,2),u=d[0],j=d[1],m=function(e){switch(e){case De:return["Temperature (Celcius)","Humidity (%)"];case Le:return["Light Intensity (%)"]}}(e.type);return Object(a.jsx)("div",{children:Object(a.jsxs)(qn.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(En.a,{id:"demo-controlled-open-select-label",children:"Measurement"}),Object(a.jsx)(_n.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){j(!1)},onOpen:function(){j(!0)},value:i,onChange:function(n){s(n.target.value),e.selectMeasurementType(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(Hn.a,{value:e,children:e},n)})):null})]})})}var st=Object(v.a)((function(e){return{root:{display:"flex"},wrapDiv:{display:"flex",justifyContent:"flex-start",flexDirection:"column"},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)},label:{marginTop:e.spacing(2),marginBottom:e.spacing(2),paddingLeft:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px"}}}));function rt(e){var n=st(),t=o.a.useState(!0),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(""),d=Object(r.a)(l,2),u=d[0],m=d[1],p=o.a.useState(""),g=Object(r.a)(p,2),b=g[0],h=g[1],x=o.a.useState(""),O=Object(r.a)(x,2),v=O[0],y=O[1],N=o.a.useState(""),k=Object(r.a)(N,2),I=k[0],S=k[1],T=o.a.useState(""),R=Object(r.a)(T,2),B=R[0],A=R[1],D=o.a.useState(""),L=Object(r.a)(D,2),F=L[0],z=L[1],M=o.a.useState({message:null,color:null}),G=Object(r.a)(M,2),W=G[0],P=G[1],E=o.a.useState(!1),H=Object(r.a)(E,2),q=H[0],_=H[1],U=function(){e.closeDialog(),s(!1),P({message:null,color:null}),h(""),m(""),y(""),S(""),A(""),z("")};return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:i,onClose:U,children:[Object(a.jsx)(Ye.a,{children:"Sensor-Based Action"}),Object(a.jsx)(gn.a,{dividers:!0,children:Object(a.jsxs)("div",{className:n.wrapDiv,children:[Object(a.jsxs)("div",{className:n.picker,children:[Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"Trigger"}),Object(a.jsx)(Vn,{sensors:e.sensors,selectSensor:h,isCommandSensor:!0})]}),""===b?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Kn,{type:b.type,selectCommand:y})}),Object(a.jsxs)("div",{className:n.picker,children:[Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"When"}),Object(a.jsx)(Vn,{sensors:e.sensors,selectSensor:m,isCommandSensor:!1})]}),""===u?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(it,{type:u.type,selectMeasurementType:S})}),Object(a.jsx)(ct,{selectComparison:z,selectQuantity:A}),W.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:W.color},children:W.message}),Object(a.jsx)("br",{})]})]})}),Object(a.jsx)(pn.a,{children:!0===q?Object(a.jsx)(xe.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(j.a,{className:n.cancelButton,variant:"contained",onClick:U,color:"primary",children:"Cancel"}),Object(a.jsx)(j.a,{variant:"contained",onClick:function(){P({message:null,color:null}),_(!0),C.a.post(w+"api/sensorBasedActions",{sensorType:b.type,sensorName:b.name,deviceId:b.deviceId,roomName:b.room,command:v,commandTopic:b.commandTopic,registrationDate:Date.now(),measurementSensorName:u.name,measurementDeviceId:u.deviceId,measurementRoomName:u.room,comparisonType:F,quantity:B,measurementType:I}).then((function(n){e.updateActions(n.data._id),_(!1),P({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),P({message:e.response.data.message,color:"red"})),_(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var lt=t(196),dt=t.n(lt),ut=Object(Qn.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:14,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(Yn.a),jt=Object(v.a)((function(e){return{margin:{margin:e.spacing(1),paddingTop:e.spacing(1)}}}));function mt(e){var n=jt(),t=o.a.useState(""),c=Object(r.a)(t,2),i=c[0],s=c[1];return Object(a.jsx)("div",{children:Object(a.jsxs)(qn.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(En.a,{required:!0,htmlFor:"demo-customized-textbox",children:"Maximum radius around the house location (in meters)"}),Object(a.jsx)(ut,{type:"number",id:"demo-customized-textbox",value:i,onChange:function(n){s(n.target.value),e.selectRadius(n.target.value)}})]})})}var pt=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},extendedIcon:{marginRight:e.spacing(1)},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(4)},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)},label:{marginTop:e.spacing(2),marginBottom:e.spacing(2),padding:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px"}}}));function gt(e){var n=pt(),t=o.a.useState(!0),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(""),d=Object(r.a)(l,2),u=d[0],m=d[1],p=o.a.useState(""),g=Object(r.a)(p,2),b=g[0],h=g[1],x=o.a.useState(""),O=Object(r.a)(x,2),f=O[0],v=O[1],y=o.a.useState({message:null,color:null}),N=Object(r.a)(y,2),k=N[0],I=N[1],S=o.a.useState(!1),T=Object(r.a)(S,2),R=T[0],B=T[1],A=function(){e.closeDialog(),s(!1),I({message:null,color:null}),m(""),h(""),v("")};return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Xe.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:i,onClose:A,children:[Object(a.jsx)(Ye.a,{children:"Location-Based Action"}),Object(a.jsxs)(gn.a,{dividers:!0,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Vn,{sensors:e.sensors,isCommandSensor:!0,selectSensor:m})}),""===u?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Kn,{type:u.type,selectCommand:h})}),Object(a.jsx)(mt,{selectRadius:v}),k.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:k.color},children:k.message}),Object(a.jsx)("br",{})]})]}),Object(a.jsx)(pn.a,{children:!0===R?Object(a.jsx)(xe.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(j.a,{className:n.cancelButton,variant:"contained",onClick:A,color:"primary",children:"Cancel"}),Object(a.jsx)(j.a,{variant:"contained",onClick:function(){I({message:null,color:null}),B(!0),C.a.post(w+"api/locationBasedActions",{sensorType:u.type,sensorName:u.name,deviceId:u.deviceId,roomName:u.room,command:b,commandTopic:u.commandTopic,registrationDate:Date.now(),radius:f}).then((function(n){e.updateActions(n.data._id),B(!1),I({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),I({message:e.response.data.message,color:"red"})),B(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var bt=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function ht(e){var n=bt(),t=o.a.useState(!0),i=Object(r.a)(t,2),s=i[0],l=i[1],d=o.a.useState(null),u=Object(r.a)(d,2),m=u[0],p=u[1];Object(c.useEffect)((function(){var e;e=p,BackgroundGeolocation.checkStatus((function(n){console.log("[INFO] BackgroundGeolocation service is running",n.isRunning),console.log("[INFO] BackgroundGeolocation services enabled",n.locationServicesEnabled),console.log("[INFO] BackgroundGeolocation auth status: "+n.authorization),1===n.authorization?e(!0):e(!1),console.log(n.authorization)}))}),[]);var g=function(){e.closeDialog(),l(!1)},b=null;return null!==m&&(m?b=Object(a.jsx)(gt,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:e.closeDialog}):(BackgroundGeolocation.removeAllListeners(),b=Object(a.jsxs)(Xe.a,{open:s,onClose:g,children:[Object(a.jsx)(Ye.a,{children:"Location-Based Action"}),Object(a.jsx)(gn.a,{dividers:!0,children:"When prompted, you must accept all asked permissions in order for the location services of this app to work. Otherwise this feature will remain disabled."}),Object(a.jsx)(pn.a,{children:Object(a.jsx)(j.a,{variant:"contained",onClick:function(){var e;e=p,BackgroundGeolocation.configure({locationProvider:BackgroundGeolocation.ACTIVITY_PROVIDER,desiredAccuracy:BackgroundGeolocation.HIGH_ACCURACY,stationaryRadius:1,distanceFilter:1,notificationTitle:"Background tracking",notificationText:"enabled",debug:!0,interval:1e4,fastestInterval:5e3,activitiesInterval:1e4,url:"http://192.168.1.66:5000/api/location",httpHeaders:{"X-FOO":"bar"},postTemplate:{lat:"@latitude",lon:"@longitude",foo:"bar"}}),BackgroundGeolocation.on("location",(function(e){console.log(e),BackgroundGeolocation.startTask((function(e){BackgroundGeolocation.endTask(e)}))})),BackgroundGeolocation.on("stationary",(function(e){})),BackgroundGeolocation.on("error",(function(e){console.log("[ERROR] BackgroundGeolocation error:",e.code,e.message)})),BackgroundGeolocation.on("start",(function(){console.log("[INFO] BackgroundGeolocation service has been started")})),BackgroundGeolocation.on("stop",(function(){console.log("[INFO] BackgroundGeolocation service has been stopped")})),BackgroundGeolocation.on("authorization",(function(e){console.log("[INFO] BackgroundGeolocation authorization status: "+e),e!==BackgroundGeolocation.AUTHORIZED&&setTimeout((function(){if(confirm("App requires location tracking permission. Would you like to open app settings?"))return BackgroundGeolocation.showAppSettings()}),1e3)})),BackgroundGeolocation.on("background",(function(){console.log("[INFO] App is in background"),BackgroundGeolocation.configure({debug:!0})})),BackgroundGeolocation.on("foreground",(function(){console.log("[INFO] App is in foreground"),BackgroundGeolocation.configure({debug:!1})})),BackgroundGeolocation.on("abort_requested",(function(){console.log("[INFO] Server responded with 285 Updates Not Required")})),BackgroundGeolocation.on("http_authorization",(function(){console.log("[INFO] App needs to authorize the http requests")})),BackgroundGeolocation.checkStatus((function(n){console.log("[INFO] BackgroundGeolocation service is running",n.isRunning),console.log("[INFO] BackgroundGeolocation services enabled",n.locationServicesEnabled),console.log("[INFO] BackgroundGeolocation auth status: "+n.authorization),console.log(n.isRunning),!n.isRunning&&n.locationServicesEnabled&&(BackgroundGeolocation.start(),e(!0))})),g()},color:"primary",children:"Enable Location Services"})})]}))),Object(a.jsx)("div",{className:n.root,children:b})}var xt=Object(v.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},action:{margin:e.spacing(2),backgroundColor:e.palette.primary.main}}}));function Ot(e){var n=xt(),t=o.a.useState(!1),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(null),d=Object(r.a)(l,2),u=d[0],j=d[1],m=function(){j(null)},p=null;switch(u){case"timerAction":p=Object(a.jsx)(nt,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:m});break;case"sensorBasedAction":p=Object(a.jsx)(rt,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:m});break;case"locationBasedAction":p=Object(a.jsx)(ht,{closeDialog:m,sensors:e.sensors,updateActions:e.updateActions})}return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Rn.a,{ariaLabel:"SpeedDial openIcon",className:n.speedDial,icon:Object(a.jsx)(Bn.a,{openIcon:Object(a.jsx)(dt.a,{})}),onClose:function(){s(!1)},onOpen:function(){s(!0)},open:i,children:[Object(a.jsx)(An.a,{className:n.action,icon:Object(a.jsx)(Ne.a,{}),tooltipTitle:"Sensor Based",onClick:function(){j("sensorBasedAction")}}),Object(a.jsx)(An.a,{className:n.action,icon:Object(a.jsx)(zn.a,{}),tooltipTitle:"Location Based",onClick:function(){j("locationBasedAction")}}),Object(a.jsx)(An.a,{className:n.action,icon:Object(a.jsx)(Ln.a,{}),tooltipTitle:"Time Based",onClick:function(){j("timerAction")}}),p]})})}var ft=w+"api/actions",vt=Object(v.a)((function(e){return{root:{margin:e.spacing(1)}}}));function yt(e){var n=vt(),t=Object(c.useState)({actions:[],isFetching:!1}),o=Object(r.a)(t,2),i=o[0],s=o[1],l=Object(c.useState)(null),d=Object(r.a)(l,2),u=d[0],j=d[1],m=function(e){j(e)};return Object(c.useEffect)((function(){return function(){var e=Object(H.a)(P.a.mark((function e(){var n;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s({actions:[],isFetching:!0}),e.next=4,C.a.get(ft);case 4:n=e.sent,s({actions:n.data,isFetching:!1}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),s({actions:[],isFetching:!1});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}()(),function(){console.log("unmounting actions")}}),[u]),Object(a.jsxs)("div",{className:n.root,children:[0!==i.actions.length?i.actions.map((function(e){return Object(a.jsx)("div",{className:n.root,children:Object(a.jsx)(Tn,{action:e,updateActions:m})},e._id)})):Object(a.jsx)(Pe,{displayItem:"Actions"}),Object(a.jsx)(Ot,{sensors:e.sensors,updateActions:m})]})}var Ct=Object(v.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(1)},title:{flexGrow:1}}}));function Nt(e){var n=Ct(),t=o.a.useState({open:!1,dialogItems:null}),c=Object(r.a)(t,2),i=c[0],s=c[1],l=o.a.useState(void 0),d=Object(r.a)(l,2),u=d[0],m=d[1];return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(ce.a,{position:"static",children:Object(a.jsxs)(oe.a,{variant:"dense",children:[Object(a.jsx)(j.a,{size:"small",onClick:e.showAllSensors,color:"inherit",children:"All"}),Object(a.jsx)(j.a,{size:"small",onClick:function(){s({open:!0,dialogItems:{contents:e.rooms,name:"Rooms",type:"room"}})},color:"inherit",children:"Rooms"}),Object(a.jsx)(j.a,{size:"small",onClick:function(){s({open:!0,dialogItems:{contents:e.categories,name:"Sensor Types",type:"sensor-type"}})},color:"inherit",children:"Types"})]})}),null!==i.dialogItems?Object(a.jsx)(on,{name:i.dialogItems.name,type:i.dialogItems.type,contents:i.dialogItems.contents,selectedValue:u,open:i.open,onClose:function(n){s({open:!1,dialogItems:null}),m(n),n&&e.selectItem({selected:n,type:i.dialogItems.type})}}):null]})}function kt(){return Object(a.jsxs)(f.a,{variant:"body2",color:"textPrimary",align:"center",children:["Copyright \xa9 ","Home Automation ",(new Date).getFullYear(),"."]})}var It=Object(v.a)((function(e){return{root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(L.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{backgroundColor:e.palette.secondary.main,zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:200,width:"calc(100% - ".concat(200,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1,paddingTop:5},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:200,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(ne.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.down("sm"),{width:e.spacing(0)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(1),display:"flex",overflow:"auto",flexDirection:"column",borderRadius:"10px",backgroundColor:e.palette.secondary.main},primaryAction:Object(ne.a)({borderRadius:"10px"},e.breakpoints.down("sm"),{display:"none"}),dashBoardLabel:{},currentTab:{textAlign:"center",marginTop:e.spacing(2)},hiMessage:{marginRight:e.spacing(2)},behindBackground:{backgroundImage:"url(".concat(S,"/static/media/home-automation4.cc5ee920.svg)"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:"100vw",height:"100vh"}}}));var St=Object(d.g)((function(e){var n=It(),t=o.a.useState(!1),c=Object(r.a)(t,2),i=c[0],s=c[1],d=o.a.useState({selected:"All",type:"all"}),u=Object(r.a)(d,2),p=u[0],h=u[1],x=function(){k(),e.history.push("/login")},O=function(){s(!1)},v=function(){h({selected:"All",type:"all"})},y={tab:"All",content:null};switch(p.type){case"room":y.tab="Room",y.content=p.selected;break;case"sensor-type":y.tab="Sensor Type",y.content=p.selected;break;case"actions":y.tab="Actions",y.content=null;break;default:y.tab="All",y.content=null}var C=Object(ee.a)(new Set(e.sensors.map((function(e){return e.room})))),N=Object(ee.a)(new Set(e.sensors.map((function(e){return e.type})))),I=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}();return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(ce.a,{position:"absolute",className:Object(te.a)(n.appBar,i&&n.appBarShift),children:Object(a.jsxs)(oe.a,{className:n.toolbar,children:[Object(a.jsx)(re.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){s(!0)},className:Object(te.a)(n.menuButton,i&&n.menuButtonHidden),children:Object(a.jsx)(ue.a,{})}),Object(a.jsx)("div",{className:n.title,children:Object(a.jsx)(rn.a,{href:"/",component:l.b,to:"/",color:"primary",underline:"none",variant:"h5",children:Object(a.jsx)("img",{src:"".concat(S,"/static/media/home-automation.1ec2cf5b.svg"),alt:"",height:50})})}),Object(a.jsxs)(f.a,{variant:"body2",className:n.hiMessage,children:["Hi, ",I.name]}),Object(a.jsx)(j.a,{variant:"contained",className:n.primaryAction,onClick:x,color:"primary",children:"Log Out"})]})}),Object(a.jsxs)(ae.a,{variant:"temporary",classes:{paper:Object(te.a)(n.drawerPaper,!i&&n.drawerPaperClose)},open:i,onClose:O,children:[Object(a.jsx)("div",{className:n.toolbarIcon,children:Object(a.jsx)(re.a,{onClick:O,children:Object(a.jsx)(me.a,{})})}),Object(a.jsx)(se.a,{}),Object(a.jsxs)(ie.a,{children:[Object(a.jsxs)(pe.a,{button:!0,onClick:v,children:[Object(a.jsx)(ge.a,{children:Object(a.jsx)(_e.a,{color:"primary"})}),Object(a.jsx)(be.a,{primary:"All"})]}),Object(a.jsx)(sn,{contents:C,selectItem:h,name:"Rooms",type:"room"}),Object(a.jsx)(sn,{contents:N,selectItem:h,name:"Sensor Types",type:"sensor-type"})]}),Object(a.jsx)(se.a,{}),Object(a.jsxs)(ie.a,{children:[Object(a.jsxs)(pe.a,{button:!0,onClick:function(){h({selected:"Actions",type:"actions"})},children:[Object(a.jsx)(ge.a,{children:Object(a.jsx)(Ve.a,{color:"primary"})}),Object(a.jsx)(be.a,{primary:"Actions"})]}),Object(a.jsxs)(pe.a,{button:!0,onClick:x,children:[Object(a.jsx)(ge.a,{children:Object(a.jsx)(Ke.a,{color:"primary"})}),Object(a.jsx)(be.a,{primary:"Log Out"})]})]})]}),Object(a.jsx)("div",{className:n.behindBackground,children:Object(a.jsxs)("main",{className:n.content,children:[Object(a.jsx)("div",{className:n.appBarSpacer}),Object(a.jsx)(Nt,{selectItem:h,rooms:C,categories:N,showAllSensors:v}),Object(a.jsxs)("div",{className:n.currentTab,children:[Object(a.jsx)(f.a,{variant:"h5",gutterBottom:!0,className:n.dashBoardLabel,children:"Dashboard"}),Object(a.jsxs)(f.a,{variant:"h6",children:[y.tab,"All"===y.tab||"Actions"===y.tab?null:" | ",y.content]})]}),Object(a.jsxs)(le.a,{maxWidth:"lg",className:n.container,children:["Actions"===p.selected?Object(a.jsx)("div",{children:Object(a.jsx)(g.a,{className:n.paper,elevation:10,children:Object(a.jsx)(yt,{sensors:e.sensors})})}):Object(a.jsx)(He,{sensors:e.sensors,filtered:p.type,selected:p.selected}),Object(a.jsx)(b.a,{pt:4,children:Object(a.jsx)(kt,{})})]})]})})]})})),wt=w+"api/activeSensors",Tt=function(){var e=Object(c.useState)({sensors:[]}),n=Object(r.a)(e,2),t=n[0],o=n[1],i=Object(c.useRef)(t);return Object(c.useEffect)((function(){(function(){var n=Object(H.a)(P.a.mark((function n(){var t,a,c,s;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C.a.get(wt);case 3:t=n.sent,o({sensors:t.data}),i.current={sensors:t.data},a=Object(E.a)(t.data);try{for(a.s();!(c=a.n()).done;)s=c.value,K.subscribe(e,s.pubTopic)}catch(r){a.e(r)}finally{a.f()}n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0),o({sensors:[]});case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}})()();var e=K.getClient();console.log(e);var n=function(n,t,a){if(console.log(t.toString(),n),"browser"!==n);else{var c=JSON.parse(t.toString());if("disconnected"===c.action){var s={sensors:i.current.sensors.filter((function(n){return n.deviceId===c.deviceId&&K.unsubscribe(e,n.pubTopic),n.deviceId!==c.deviceId})),alertMessage:{device:c.deviceId,reason:c.action}};i.current=s,o(s)}else if("connected"===c.action){if(i.current.sensors.find((function(e){return e.deviceId===c.newSensors[0].deviceId})))return void console.log("Exists!!! No action taken!");var r,l={sensors:i.current.sensors.concat(c.newSensors),alertMessage:{device:c.newSensors[0].deviceId,reason:c.action}},d=Object(E.a)(c.newSensors);try{for(d.s();!(r=d.n()).done;){var u=r.value;K.subscribe(e,u.pubTopic)}}catch(m){d.e(m)}finally{d.f()}i.current=l,o(l)}else if("action"===c.action){console.log(c);var j={sensors:i.current.sensors,alertMessage:{reason:c.action,actionCategory:c.actionInfo.actionCategory,command:c.actionInfo.command,roomName:c.actionInfo.roomName,sensorName:c.actionInfo.sensorName}};i.current=j,o(j)}}};return e.on("message",n),function(){console.log("Dashboard was unmounted!"),e.off("message",n)}}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)($,{alertMessage:t.alertMessage}),Object(a.jsx)(St,{sensors:t.sensors,alertMessage:t.alertMessage})]})};var Rt=function(){var e=Object(c.useState)(!0),n=Object(r.a)(e,2),t=n[0],o=n[1];return Object(c.useEffect)((function(){var e=N();e&&C.a.get("http://localhost:5000/api/verifyToken?token=".concat(e)).then((function(e){I(e.data.token,e.data.user),o(!1)})).catch((function(e){alert(e),k(),o(!1)}))}),[]),t&&N()?Object(a.jsx)("div",{className:"content",children:"Checking Authentication..."}):Object(a.jsx)(l.a,{children:Object(a.jsxs)(d.d,{children:[Object(a.jsx)(z,{path:"/dashboard",component:Tt}),Object(a.jsx)(G,{path:"/",component:A})]})})},Bt=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,404)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,o=n.getLCP,i=n.getTTFB;t(e),a(e),c(e),o(e),i(e)}))},At=t(386),Dt=t(206),Lt=Object(Dt.a)({palette:{background:{default:"#FFF",emphasis:"#E8EAF6",secondary:"#C5CAE9",header:"#121037"},text:{primary:"#615f5d",secondary:"#999693",hint:"#ccc8c4",whiteText:"white"},primary:{main:"#000000",light:"#333333",dark:"#545454"},secondary:{main:"#b09058",light:"#deb66f",dark:"#9c7f4e"},contrastThreshold:1.8}}),Ft=function(){s.a.render(Object(a.jsxs)(At.a,{theme:Lt,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(Rt,{})]}),document.getElementById("root"))};window.cordova?document.addEventListener("deviceready",(function(){Ft()}),!1):Ft(),Bt()}},[[317,1,2]]]);
//# sourceMappingURL=main.a0ab3387.chunk.js.map