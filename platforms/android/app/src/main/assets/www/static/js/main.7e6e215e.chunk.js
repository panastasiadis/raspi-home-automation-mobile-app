(this["webpackJsonpio.cordova.hellocordova"]=this["webpackJsonpio.cordova.hellocordova"]||[]).push([[0],{234:function(e,n,t){},235:function(e,n,t){},266:function(e,n){},268:function(e,n){},303:function(e,n){},304:function(e,n){},306:function(e,n){},308:function(e,n){},317:function(e,n,t){"use strict";t.r(n);var a=t(1),c=t(0),i=t.n(c),o=t(13),s=t.n(o),r=(t(234),t(7)),l=(t(235),t(66)),d=t(22),u=t(393),p=t(128),j=t(364),m=t(394),g=t(142),b=t(387),h=t(363),x=t(187),O=t.n(x),f=t(53),v=t(63),y=t(24),N=t.n(y),C=function(){return sessionStorage.getItem("token")||null},k=function(){sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},I=function(e,n){sessionStorage.setItem("token",e),sessionStorage.setItem("user",JSON.stringify(n))},S="";document.addEventListener("deviceready",(function(){S="".concat(window.cordova.file.applicationDirectory,"www")}),!1);var w="http://192.168.1.66:5000/",R="http://192.168.1.66:8883";function T(){return Object(a.jsxs)(f.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ","Home Automation ",(new Date).getFullYear(),"."]})}var A=Object(v.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(".concat(S,"/static/media/home-automation3.2481b425.svg)"),backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function B(e){var n=A(),t=D(""),i=D(""),o=Object(c.useState)(null),s=Object(r.a)(o,2),l=s[0],d=s[1],x=Object(c.useState)(!1),v=Object(r.a)(x,2),y=(v[0],v[1]);return Object(a.jsxs)(h.a,{container:!0,component:"main",className:n.root,children:[Object(a.jsx)(j.a,{}),Object(a.jsx)(h.a,{item:!0,xs:!1,sm:4,md:7,className:n.image}),Object(a.jsx)(h.a,{item:!0,xs:12,sm:8,md:5,component:g.a,elevation:6,square:!0,children:Object(a.jsxs)("div",{className:n.paper,children:[Object(a.jsx)(u.a,{className:n.avatar,children:Object(a.jsx)(O.a,{})}),Object(a.jsx)(f.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:n.form,noValidate:!0,children:[Object(a.jsx)(m.a,{variant:"filled",color:"secondary",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,onChange:t.onChange}),Object(a.jsx)(m.a,{variant:"filled",color:"secondary",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:i.onChange}),l&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:"red"},children:l}),Object(a.jsx)("br",{})]}),Object(a.jsx)(p.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,onClick:function(){d(null),y(!0),N.a.post(w+"api/users/signin",{username:t.value,password:i.value}).then((function(n){y(!1),I(n.data.token,n.data.user),e.history.push("/dashboard")})).catch((function(e){console.log(e),console.log(e.response),alert(e),y(!1),e.response?401!==e.response.status&&400!==e.response.status||d(e.response.data.message):d("Something went wrong. Please try again later.")}))},children:"Sign In"}),Object(a.jsx)(b.a,{mt:5,children:Object(a.jsx)(T,{})})]})]})})]})}var D=function(e){var n=Object(c.useState)(e),t=Object(r.a)(n,2),a=t[0],i=t[1];return{value:a,onChange:function(e){i(e.target.value)}}},L=t(48),F=t(126);var M=function(e){var n=e.component,t=Object(F.a)(e,["component"]);return Object(a.jsx)(d.b,Object(L.a)(Object(L.a)({},t),{},{render:function(e){return C()?Object(a.jsx)(n,Object(L.a)({},e)):Object(a.jsx)(d.a,{to:{pathname:"/",state:{from:e.location}}})}}))};var z,E=function(e){var n=e.component,t=Object(F.a)(e,["component"]);return Object(a.jsx)(d.b,Object(L.a)(Object(L.a)({},t),{},{render:function(e){return C()?Object(a.jsx)(d.a,{to:{pathname:"/dashboard"}}):Object(a.jsx)(n,Object(L.a)({},e))}}))},G=t(49),W=t.n(G),P=t(108),H=t(75),q=t(188),_=t.n(q),U=R,V="mqttjs_brower_"+Math.random().toString(16).substr(2,4),J={keepalive:30,clientId:V,protocolId:"MQTT",protocolVersion:4,clean:!0,reconnectPeriod:1e3,connectTimeout:3e4,will:{topic:"WillMsg",payload:"Connection Closed abnormally..!",qos:0,retain:!1},rejectUnauthorized:!1},K={getClient:function(){return z||((z=_.a.connect(U,J)).subscribe("browser"),z.on("error",(function(e){console.log("Connection to ".concat(U," failed"),e),z.end()})),z.on("close",(function(){console.log(V+" disconnected")}))),z},publishMessage:function(e,n,t){e.publish(n,t)},subscribe:function(e,n){return e.subscribe(n,(function(e,n){e&&console.log("Subscription request failed")}))},onMessage:function(e,n){e.on("message",(function(t,a,c){console.log(a.toString(),t),n(e,t,a)}))},unsubscribe:function(e,n){e.unsubscribe(n)},closeConnection:function(e){e.end(),e=void 0},extractMqttTopicInfo:function(e){var n=e.split("/"),t=Object(r.a)(n,4);return{room:t[0],deviceId:t[1],type:t[2],sensorName:t[3]}}},Q=t(389),Y=t(390),X="Lightbulb",Z="ON",$="OFF",ee="Turn the lights on",ne="Turn the lights off",te="Turning the lights on!",ae="Turning the lights off!",ce="Motion-Detector",ie="Detection status",oe="Motion detected",se="No motion detected",re="Temperature-Humidity",le="Temperature (Celcius)",de="Celcius",ue="Humidity (%)",pe="%",je="Light-Intensity",me="Light Intensity (%)",ge="%",be=X,he=re,xe=je,Oe=ce,fe=[je,re],ve=[X,ce],ye=function(e,n){switch(e){case be:var t={command:Z,description:ee,commandOnFailure:$},a={command:$,description:ne,commandOnFailure:Z};switch(n){case Z:return t;case $:return a;default:return[t,a]}}},Ne=function(e){return fe.includes(e)?"measurement":ve.includes(e)?"options":void 0};function Ce(e){return Object(a.jsx)(Q.a,Object(L.a)({elevation:6,variant:"filled"},e))}var ke=Object(v.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function Ie(e){var n,t,i,o,s=ke(),l=Object(c.useState)(!!e.alertMessage),d=Object(r.a)(l,2),u=d[0],p=d[1],j=function(e,n){"clickaway"!==n&&p(!1)};if(Object(c.useEffect)((function(){p(!!e.alertMessage)}),[e]),e.alertMessage&&(n=e.alertMessage.device,t=e.alertMessage.reason),"connected"===t?i="success":"disconnected"===t?i="error":"action"===t&&(i="info"),"action"===t){var m=function(e,n){switch(e){case X:switch(n){case Z:return te;case $:return ae}}}(e.alertMessage.sensorType,e.alertMessage.command);o="".concat(e.alertMessage.actionCategory,": ").concat(m," (").concat(e.alertMessage.sensorType," | ").concat(e.alertMessage.roomName,")")}else o="".concat(n," was ").concat(t);return Object(a.jsx)("div",{className:s.root,children:Object(a.jsx)(Y.a,{open:u,onClose:j,autoHideDuration:6e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:Object(a.jsx)(Ce,{severity:i,onClose:j,children:o})})})}var Se=t(141),we=t(62),Re=t(4),Te=t(396),Ae=t(383),Be=t(381),De=t(369),Le=t(378),Fe=t(210),Me=t(385),ze=t(200),Ee=t.n(ze),Ge=t(201),We=t.n(Ge),Pe=t(323),He=t(374),qe=t(373),_e=t(401),Ue=t(370),Ve=t(39),Je=t.n(Ve),Ke=t(34),Qe=t.n(Ke),Ye=t(35),Xe=t.n(Ye),Ze=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},imageLightOpen:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/lightbulb-open2.d67991f2.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},imageLightClosed:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/lightbulb-closed2.909d2ca0.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},currentState:{display:"flex",alignItems:"center",padding:e.spacing(1)},onOff:{marginLeft:e.spacing(1),padding:e.spacing(1),color:e.palette.secondary.main,borderStyle:"dashed",borderColor:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},circularProgress:{display:"inline","& > * + *":{marginLeft:e.spacing(2)}}}}));function $e(e){var n=Ze(),t=Object(c.useState)("Loading..."),i=Object(r.a)(t,2),o=i[0],s=i[1],l="ON"===o,d=Object(c.useState)({spinner:!1,disabled:!0}),u=Object(r.a)(d,2),p=u[0],j=u[1];return Object(c.useEffect)((function(){var n=K.getClient(),t=function(n,t,a){console.log(t.toString(),n),n===e.topic&&(s(t.toString()),j({spinner:!1,disabled:!1}))};return n.on("message",t),function(){console.log("unmounting relay"),n.off("message",t)}}),[e.topic]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:["ON"===o?Object(a.jsx)("div",{className:n.imageLightOpen}):Object(a.jsx)("div",{className:n.imageLightClosed}),Object(a.jsxs)("div",{className:n.currentState,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Current state "}),Object(a.jsx)(f.a,{className:n.onOff,variant:"subtitle2",children:o})]}),!0===p.spinner?Object(a.jsx)("div",{className:n.circularProgress,children:Object(a.jsx)(Ue.a,{})}):null,Object(a.jsx)(_e.a,{onChange:function(n){var t=K.getClient();console.log(t,e.command),n.target.checked?K.publishMessage(t,e.command,"ON"):K.publishMessage(t,e.command,"OFF"),j({spinner:!0,disabled:!0})},checked:l,disabled:p.disabled})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Xe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.name})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Je.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var en=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},progressBar:{textAlign:"center",width:"100%"},brightnessIcon:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/brightness.f2162df0.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:30,height:30},degrees:{textAlign:"center",backgroundColor:e.palette.secondary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"}}}));function nn(e){var n=en(),t=e.value;return e.value>100&&(t=100),Object(a.jsxs)(b.a,{position:"relative",display:"inline-flex",children:[Object(a.jsx)(Ue.a,{variant:"determinate",value:t,size:100}),Object(a.jsx)(b.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)("div",{className:n.brightnessIcon}),Object(a.jsx)(f.a,{variant:"body2",component:"div",color:"textSecondary",children:"".concat(Math.round(t),"%")})]})})]})}function tn(e){var n=en(),t=Object(c.useState)({brightness:"Loading...",percentage:0}),o=Object(r.a)(t,2),s=o[0],l=o[1];return i.a.useEffect((function(){var n=K.getClient(),t=function(n,t,a){if(console.log(t.toString(),n),n===e.topic){var c=t.toString(),i=parseFloat(c);l({brightness:c,percentage:i})}};return n.on("message",t),function(){console.log("unmounting light intensity"),n.off("message",t)}}),[e.topic]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)("div",{className:n.progressBar,children:Object(a.jsx)(nn,{value:s.percentage})}),Object(a.jsx)(f.a,{className:n.degrees,children:"".concat(s.brightness," lux")})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Xe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Je.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var an=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},degrees:{textAlign:"center",backgroundColor:e.palette.secondary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"},imageTemperature:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/thermometer.26bec6cd.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},imageHumidity:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/humidity.41d15f93.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},imageAverage:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/average.9152ffbf.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:50,height:50},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(1)},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},tempHum:{display:"flex",flexWrap:"wrap",justifyContent:"center"},averageMeasurementsDiv:{display:"flex",alignItems:"center",flexDirection:"column",backgroundColor:e.palette.secondary.main,padding:e.spacing(1),borderRadius:"10px",margin:e.spacing(1),color:"white"}}}));function cn(e){var n=an(),t=Object(c.useState)({avgTemp:null,avgHum:null,isFetching:!1}),i=Object(r.a)(t,2),o=i[0],s=i[1],l=Object(c.useState)({temperature:"Loading...",humidity:"Loading..."}),d=Object(r.a)(l,2),u=d[0],p=d[1],j="No Samples yet";return null!==o.avgTemp&&(j="".concat(Math.round(o.avgTemp),"\xb0C /\n    ").concat(Math.round(o.avgHum),"%")),Object(c.useEffect)((function(){(function(){var n=Object(H.a)(W.a.mark((function n(){var t,a,c,i,o,r,l;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s({avgTemp:null,avgHum:null,isFetching:!0}),n.next=4,N.a.get("".concat(w,"api/measurements/").concat(e.sensorName));case 4:t=n.sent,a=0,c=0,i=0,o=Object(P.a)(t.data);try{for(o.s();!(r=o.n()).done;)l=r.value,a+=l.temperaturesSum,c+=l.humiditiesSum,i+=l.measurementsCounter}catch(d){o.e(d)}finally{o.f()}console.log(t.data),0!==t.data.length&&s({avgTemp:a/=i,avgHum:c/=i,isFetching:!1}),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),console.log(n.t0),s({avgTemp:null,avgHum:null,isFetching:!1});case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(){return n.apply(this,arguments)}})()();var n=K.getClient(),t=function(n,t,a){if(console.log(t.toString(),n),n===e.topic){var c=t.toString().split("-");p({temperature:c[0],humidity:c[1]})}};return n.on("message",t),function(){console.log("unmounting temp-hum"),n.off("message",t)}}),[e.topic,e.sensorName]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.averageMeasurementsDiv,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Average"}),Object(a.jsx)("div",{className:n.imageAverage}),Object(a.jsx)(f.a,{className:n.degrees,children:j})]}),Object(a.jsxs)("div",{className:n.tempHum,children:[Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Temperature"}),Object(a.jsx)("div",{className:n.imageTemperature}),Object(a.jsxs)(f.a,{className:n.degrees,children:["".concat(u.temperature," \xb0C"),Object(a.jsx)("br",{})]})]}),Object(a.jsxs)("div",{className:n.divContent,children:[Object(a.jsx)(f.a,{variant:"subtitle1",children:"Humidity"}),Object(a.jsx)("div",{className:n.imageHumidity}),Object(a.jsxs)(f.a,{className:n.degrees,children:[u.humidity," %",Object(a.jsx)("br",{})]})]})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Xe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Je.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var on=Object(v.a)((function(e){return{root:{backgroundColor:"white",borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},info:{display:"flex",flexWrap:"wrap",flexGrow:1,flexDirection:"column",justifyContent:"space-around",borderRadius:"10px",margin:e.spacing(1)},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},divContent:{display:"flex",alignItems:"center",flexDirection:"column",padding:e.spacing(2)},motionImage:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/motion.8d3d8610.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},noMotionImage:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/no-motion.de1b03d8.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:70,height:70},currentState:{display:"flex",alignItems:"center",padding:e.spacing(1)},motionInfo:{textAlign:"center",backgroundColor:e.palette.secondary.main,padding:e.spacing(1),color:"white",borderRadius:"20px",fontWeight:"bold"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"}}}));function sn(e){var n=on(),t=Object(c.useState)("Loading..."),i=Object(r.a)(t,2),o=i[0],s=i[1],l=Object(c.useRef)(o),d=Object(c.useState)("No detection yet"),u=Object(r.a)(d,2),p=u[0],j=u[1];return Object(c.useEffect)((function(){var n=function(){var n=Object(H.a)(W.a.mark((function n(){var t;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,j("Fetching..."),n.next=4,N.a.get("".concat(w,"api/measurements/").concat(e.sensorName));case 4:0!==(t=n.sent).data.length&&j(new Date(t.data[0])),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0),j("No detection yet");case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();n();var t=K.getClient(),a=function(t,a,c){if(console.log(a.toString(),t),t===e.topic){var i=a.toString();"Motion detected"===l.current&&"No motion detected"===i&&n(),l.current=i,s(i)}};return t.on("message",a),function(){console.log("unmounting motion detector"),t.off("message",a)}}),[e.topic,e.sensorName]),console.log(o),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsxs)("div",{className:n.divContent,children:["Motion detected"===o?Object(a.jsx)("div",{className:n.motionImage}):Object(a.jsx)("div",{className:n.noMotionImage}),Object(a.jsx)("div",{className:n.currentState,children:Object(a.jsx)(f.a,{className:n.motionInfo,variant:"subtitle2",children:o})}),Object(a.jsx)("div",{className:n.currentState,children:Object(a.jsx)(f.a,{variant:"body2",color:"textSecondary",children:"Last detection: ".concat(p.toLocaleString()?p.toLocaleString():p)})})]}),Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsx)(f.a,{variant:"h5",children:e.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Xe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Je.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.device})]})]})]})}var rn=Object(v.a)((function(e){return{paper:{padding:e.spacing(1),display:"flex",overflow:"auto",flexDirection:"column",backgroundColor:e.palette.secondary.main,borderRadius:"10px"},title:{backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),textAlign:"center"},roomTitle:{textAlign:"center",backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1),margin:e.spacing(1)}}}));function ln(e){var n=rn();return e.sensor.type===Oe?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Motion Detector"}),Object(a.jsx)(sn,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===xe?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Room brightness"}),Object(a.jsx)(tn,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===he?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Temperature & Humidity"}),Object(a.jsx)(cn,{topic:e.sensor.pubTopic,roomName:e.sensor.room,device:e.sensor.deviceId,sensorName:e.sensor.name})]})}):e.sensor.type===be?Object(a.jsx)(h.a,{item:!0,xs:"auto",md:"auto",lg:"auto",children:Object(a.jsxs)(g.a,{className:n.paper,elevation:6,children:[Object(a.jsx)(f.a,{variant:"h6",className:n.title,children:"Lights"}),Object(a.jsx)($e,{roomName:e.sensor.room,device:e.sensor.deviceId,name:e.sensor.name,command:e.sensor.commandTopic,topic:e.sensor.pubTopic})]})}):null}var dn=Object(v.a)((function(e){return{image:{margin:e.spacing(1),padding:e.spacing(1),backgroundImage:"url(".concat(S,"/static/media/not-found.cd5a9b2a.svg)"),backgroundPosition:"center",backgroundSize:"contain",backgroundRepeat:"no-repeat",width:"80vh",height:"50vh"},divNoContent:{margin:e.spacing(1),display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},title:{margin:e.spacing(1),padding:e.spacing(1),color:"white",textAlign:"center"}}}));function un(e){var n=dn();return Object(a.jsxs)("div",{className:n.divNoContent,children:[Object(a.jsx)(f.a,{variant:"h3",component:"h3",gutterBottom:!0,className:n.title,children:e.displayItem?"No ".concat(e.displayItem," Found"):"Nothing Found"}),Object(a.jsx)("div",{className:n.image})]})}var pn=Object(v.a)((function(e){return{paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",backgroundColor:e.palette.secondary.main}}}));function jn(e){var n=pn(),t=e.sensors;return"room"===e.filtered?t=e.sensors.filter((function(n){return n.room===e.selected})):"sensor-type"===e.filtered&&(t=e.sensors.filter((function(n){return n.type===e.selected}))),0===t.length?Object(a.jsx)(g.a,{className:n.paper,elevation:10,children:Object(a.jsx)(un,{displayItem:"Devices"})}):Object(a.jsx)(h.a,{container:!0,spacing:3,justify:"center",children:t.map((function(e){return Object(a.jsx)(ln,{sensor:e},e.name)}))})}var mn=t(202),gn=t.n(mn),bn=t(203),hn=t.n(bn),xn=t(204),On=t.n(xn),fn=t(372),vn=t(371),yn=t(321),Nn=t(189),Cn=t.n(Nn),kn=t(190),In=t.n(kn),Sn=t(191),wn=t.n(Sn),Rn=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},dialogPaper:{},emptyContentLabel:{margin:36}}}));function Tn(e){var n=Rn(),t=e.onClose,c=e.open;return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(yn.a,{classes:{paper:n.dialogPaper},onClose:function(){t(void 0)},"aria-labelledby":"simple-dialog-title",open:c,children:[Object(a.jsx)(vn.a,{id:"simple-dialog-title",children:e.name}),0!==e.contents.length?Object(a.jsx)(De.a,{children:e.contents.map((function(c){return Object(a.jsxs)(Pe.a,{button:!0,onClick:function(){t(c)},children:[Object(a.jsx)(fn.a,{children:Object(a.jsx)(u.a,{className:n.avatar,children:"room"===e.type?Object(a.jsx)(Cn.a,{}):Object(a.jsx)(In.a,{})})}),Object(a.jsx)(qe.a,{primary:c})]},c)}))}):Object(a.jsxs)(f.a,{variant:"body1",color:"secondary",align:"center",className:n.emptyContentLabel,children:["No ",e.name," found."]})]})})}function An(e){var n=i.a.useState(!1),t=Object(r.a)(n,2),c=t[0],o=t[1],s=i.a.useState(void 0),l=Object(r.a)(s,2),d=l[0],u=l[1];return Object(a.jsxs)("div",{children:[Object(a.jsxs)(Pe.a,{button:!0,onClick:function(){o(!0)},children:[Object(a.jsx)(He.a,{children:"room"===e.type?Object(a.jsx)(Qe.a,{color:"primary"}):Object(a.jsx)(wn.a,{color:"primary"})}),Object(a.jsx)(qe.a,{primary:e.name})]}),Object(a.jsx)(Tn,{name:e.name,type:e.type,contents:e.contents,selectedValue:d,open:c,onClose:function(n){o(!1),u(n),n&&e.selectItem({selected:n,type:e.type})}})]})}var Bn=t(384),Dn=t(391),Ln=t(377),Fn=t(376),Mn=t(195),zn=t.n(Mn),En=t(325),Gn=t(324),Wn=t(375),Pn=t(192),Hn=t.n(Pn);function qn(e){var n=i.a.useState(!1),t=Object(r.a)(n,2),o=t[0],s=t[1],l=Object(c.useState)(null),d=Object(r.a)(l,2),u=d[0],j=d[1],m=function(){s(!1),j(null)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(Fe.a,{onClick:function(){s(!0)},color:"primary",children:Object(a.jsx)(Hn.a,{})}),Object(a.jsxs)(yn.a,{open:o,onClose:m,"aria-labelledby":"responsive-dialog-title",children:[Object(a.jsx)(vn.a,{id:"responsive-dialog-title",children:"Warning"}),Object(a.jsxs)(Gn.a,{children:[Object(a.jsx)(Wn.a,{children:"Are you sure you want to delete this action?"}),u&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:"red"},children:u}),Object(a.jsx)("br",{})]})]}),Object(a.jsxs)(En.a,{children:[Object(a.jsx)(p.a,{variant:"contained",autoFocus:!0,onClick:m,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",autoFocus:!0,onClick:function(){j(null),N.a.delete("".concat(w,"api/actions/").concat(e.action._id),{data:e.action._id}).then((function(n){e.updateActions(e.action._id.toString()+Math.random().toString(16).substr(2,8)),s(!1)})).catch((function(e){console.log(e.response),e.response?404===e.response.status&&j(e.response.data.message):j("Something went wrong. Please try again later.")}))},color:"primary",children:"Delete"})]})]})]})}var _n=t(193),Un=t.n(_n),Vn=t(194),Jn=t.n(Vn),Kn=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},timeInfoIndividual:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1)},dateLabel:{marginLeft:e.spacing(1)}}}));function Qn(e){var n=Kn();return Object(a.jsxs)("div",{className:n.accordionContent,children:[Object(a.jsxs)("div",{className:n.timeInfoIndividual,children:[Object(a.jsx)(Un.a,{}),Object(a.jsx)(f.a,{className:n.dateLabel,variant:"subtitle1",children:"Starting time: ".concat(e.date.toLocaleString())})]}),Object(a.jsxs)("div",{className:n.timeInfoIndividual,children:[Object(a.jsx)(Jn.a,{}),Object(a.jsx)(f.a,{className:n.dateLabel,variant:"subtitle1",children:e.recurrenceMessage})]})]})}var Yn=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},whenDescription:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),flexWrap:"wrap"},whenSensorDescription:{borderRadius:"10px",backgroundColor:"white",display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),flexWrap:"wrap"},labelDynamicContent:{marginLeft:e.spacing(1),marginRight:e.spacing(1),backgroundColor:e.palette.primary.main,paddingLeft:e.spacing(1),paddingRight:e.spacing(1),borderRadius:"10px"},deviceInfoIndividual:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main,borderRadius:"10px"},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},deviceInfo:Object(we.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},e.breakpoints.down("md"),{marginTop:e.spacing(2)})}}));function Xn(e){var n,t=Yn();return e.comparisonType&&e.quantity?n="When ".concat(e.measurementType," is ").concat(e.comparisonType.toLowerCase()," ").concat(e.quantity," ").concat(function(e){switch(e){case le:return de;case ue:return pe;case me:return ge}}(e.measurementType),"."):e.option&&(n="When the value of ".concat(e.measurementType,' is "').concat(e.option,'".')),Object(a.jsxs)("div",{className:t.accordionContent,children:[Object(a.jsx)("div",{className:t.whenDescription,children:n}),Object(a.jsx)("div",{className:t.whenSensorDescription,children:Object(a.jsx)(f.a,{variant:"subtitle1",color:"secondary",children:"Sensor: "+e.measurementSensorType})}),Object(a.jsxs)("div",{className:t.whenSensorDescription,children:[Object(a.jsxs)("div",{className:t.roomInfo,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementRoomName})]}),Object(a.jsxs)("div",{className:t.deviceInfoIndividual,children:[Object(a.jsx)(Xe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementSensorName})]}),Object(a.jsxs)("div",{className:t.deviceInfoIndividual,children:[Object(a.jsx)(Je.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.measurementDeviceId})]})]})]})}var Zn=Object(v.a)((function(e){return{accordionContent:{backgroundColor:e.palette.secondary.main,color:"white",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-around",borderRadius:"10px"},info:{display:"flex",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1)},label:{marginLeft:e.spacing(1)},radiusMeters:{marginLeft:e.spacing(1),paddingLeft:e.spacing(1),paddingRight:e.spacing(1),backgroundColor:e.palette.primary.main,borderRadius:"10px",color:"white"}}}));function $n(e){var n=Zn();return Object(a.jsx)("div",{className:n.accordionContent,children:Object(a.jsxs)("div",{className:n.info,children:[Object(a.jsx)("img",{src:"".concat(S,"/static/media/home-location.cc2515ec.svg"),alt:"Home Location",width:"35",height:"35"}),Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"Radius:"}),Object(a.jsx)(f.a,{className:n.radiusMeters,variant:"subtitle1",children:"".concat(e.radius)}),Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"meters"})]})})}var et=Object(v.a)((function(e){return{root:{width:"100%"},command:{color:e.palette.primary.main,fontSize:e.typography.pxToRem(15),padding:e.spacing(1),margin:e.spacing(1),flexShrink:0,borderStyle:"solid",borderColor:e.palette.primary.main,borderRadius:"10px",backgroundColor:e.palette.secondary.main},headingCommand:{borderColor:e.palette.secondary.main,borderRadius:"10px",display:"flex",flexWrap:"wrap",alignItems:"center"},heading:{width:"100px",margin:e.spacing(1),flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary,padding:e.spacing(1),margin:e.spacing(1)},summary:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-start"},deviceInfoIndividual:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),color:e.palette.secondary.main},roomInfo:{display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),margin:e.spacing(1),backgroundColor:e.palette.primary.main,color:"white",borderRadius:"10px"},deviceInfo:Object(we.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},e.breakpoints.down("md"),{marginTop:e.spacing(2)}),deleteButton:{display:"flex",justifyContent:"center"}}}));function nt(e){var n=et(),t=i.a.useState(!1),c=Object(r.a)(t,2),o=c[0],s=c[1],l=null;switch(e.action.actionCategory){case"Timer Action":var d,u;u=e.action.recurrenceNumber?"Every ".concat(e.action.recurrenceNumber," ").concat(e.action.recurrenceTimeUnit):"None",d=new Date(e.action.startTime),l=Object(a.jsx)(Qn,{recurrenceMessage:u,date:d});break;case"Sensor-Based Action":l=Object(a.jsx)(Xn,{measurementType:e.action.measurementType,quantity:e.action.quantity,comparisonType:e.action.comparisonType,measurementSensorName:e.action.measurementSensorName,measurementDeviceId:e.action.measurementDeviceId,measurementRoomName:e.action.measurementRoomName,measurementSensorType:e.action.measurementSensorType,option:e.action.option});break;case"Location-Based Action":l=Object(a.jsx)($n,{radius:e.action.radius})}var p,j=ye(e.action.sensorType,e.action.command),m=new Date(e.action.registrationDate);return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(Dn.a,{expanded:"panel1"===o,onChange:(p="panel1",function(e,n){s(!!n&&p)}),children:[Object(a.jsx)(Fn.a,{expandIcon:Object(a.jsx)(zn.a,{}),"aria-controls":"panel1bh-content",id:"panel1bh-header",children:Object(a.jsxs)("div",{className:n.summary,children:[Object(a.jsxs)("div",{className:n.headingCommand,children:[Object(a.jsx)(f.a,{variant:"subtitle1",className:n.heading,children:e.action.actionCategory}),Object(a.jsxs)(f.a,{className:n.command,children:[e.action.sensorType+" | ",j.description]})]}),Object(a.jsxs)("div",{className:n.deviceInfo,children:[Object(a.jsxs)("div",{className:n.roomInfo,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.roomName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Xe.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.sensorName})]}),Object(a.jsxs)("div",{className:n.deviceInfoIndividual,children:[Object(a.jsx)(Je.a,{}),Object(a.jsx)(f.a,{variant:"subtitle1",children:e.action.deviceId})]})]}),Object(a.jsxs)(f.a,{className:n.secondaryHeading,children:["Registered on: ",m.toLocaleString()]})]})}),Object(a.jsx)(Ln.a,{children:l}),Object(a.jsx)(Le.a,{}),Object(a.jsx)("div",{className:n.deleteButton,children:Object(a.jsx)(qn,{action:e.action,updateActions:e.updateActions})})]})})}var tt=t(399),at=t(400),ct=t(392),it=t(199),ot=t.n(it),st=t(198),rt=t.n(st),lt=t(205),dt=t(23),ut=t(380),pt=t(402),jt=t(398),mt=t(379),gt=t(367),bt=t(388),ht=Object(v.a)((function(e){return{button:{display:"block",marginTop:e.spacing(2)},formControl:{minWidth:120,maxWidth:250},menuItem:{padding:e.spacing(1),display:"flex"}}}));function xt(e){var n=ht(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(!1),d=Object(r.a)(l,2),u=d[0],p=d[1],j=null;return e.sensors&&(void 0===e.isCommandSensor?j=e.sensors:e.isCommandSensor?j=e.sensors.filter((function(e){return e.commandTopic})):e.isCommandSensor||(j=e.sensors.filter((function(e){return!e.commandTopic})))),Object(a.jsx)("div",{children:Object(a.jsxs)(gt.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(jt.a,{id:"demo-controlled-open-select-label",children:"Sensor"}),Object(a.jsxs)(bt.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:u,onClose:function(){p(!1)},onOpen:function(){p(!0)},value:o,onChange:function(n){s(n.target.value),e.selectSensor(n.target.value)},children:[Object(a.jsx)(mt.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),j?j.map((function(e){return Object(a.jsxs)(mt.a,{value:e,children:[Object(a.jsx)(Xe.a,{}),"  ",e.name,"  ",Object(a.jsx)(Qe.a,{}),"  ",e.room,"  ",Object(a.jsx)(Je.a,{}),"  ",e.deviceId]},e.name)})):null]})]})})}var Ot=Object(v.a)((function(e){return{formControl:{minWidth:120},menuItem:{padding:e.spacing(1)}}}));function ft(e){var n=Ot(),t=i.a.useState(""),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(!1),u=Object(r.a)(d,2),p=u[0],j=u[1];Object(c.useEffect)((function(){l("")}),[e.clearEntries]);var m=ye(e.type);return Object(a.jsx)("div",{children:Object(a.jsxs)(gt.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(jt.a,{id:"demo-controlled-open-select-label",children:"Command"}),Object(a.jsx)(bt.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:p,onClose:function(){j(!1)},onOpen:function(){j(!0)},value:s,onChange:function(n){l(n.target.value),e.selectCommand(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(mt.a,{value:e.command,children:e.description},n)})):null})]})})}var vt=t(5),yt=t(213),Nt=Object(vt.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(yt.a),Ct=Object(v.a)((function(e){return{margin:{margin:e.spacing(1)}}}));function kt(e){var n=Ct(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(""),d=Object(r.a)(l,2),u=d[0],p=d[1];console.log(o);return Object(a.jsxs)("div",{children:[Object(a.jsxs)(gt.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(jt.a,{htmlFor:"demo-customized-textbox",children:"Recurrence every"}),Object(a.jsx)(Nt,{type:"number",id:"demo-customized-textbox",value:o,onChange:function(n){s(n.target.value),e.selectRecurrence(n.target.value)}})]}),Object(a.jsxs)(gt.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(jt.a,{id:"demo-customized-select-label",children:"Units"}),Object(a.jsxs)(bt.a,{labelId:"demo-customized-select-label",id:"demo-customized-select",value:u,onChange:function(n){p(n.target.value),e.selectTimeUnits(n.target.value)},input:Object(a.jsx)(Nt,{}),children:[Object(a.jsx)(mt.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),Object(a.jsx)(mt.a,{value:"Minutes",children:"Minutes"}),Object(a.jsx)(mt.a,{value:"Hours",children:"Hours"}),Object(a.jsx)(mt.a,{value:"Days",children:"Days"})]})]})]})}var It=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},extendedIcon:{marginRight:e.spacing(1)},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(4)},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)}}}));function St(e){var n=It(),t=i.a.useState(!0),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(new Date),u=Object(r.a)(d,2),j=u[0],m=u[1],g=i.a.useState(""),b=Object(r.a)(g,2),h=b[0],x=b[1],O=Object(c.useRef)(h),f=i.a.useState(""),v=Object(r.a)(f,2),y=v[0],C=v[1],k=i.a.useState(""),I=Object(r.a)(k,2),S=I[0],R=I[1],T=i.a.useState(""),A=Object(r.a)(T,2),B=A[0],D=A[1],L=i.a.useState(null),F=Object(r.a)(L,2),M=F[0],z=F[1],E=i.a.useState({message:null,color:null}),G=Object(r.a)(E,2),W=G[0],P=G[1],H=i.a.useState(!1),q=Object(r.a)(H,2),_=q[0],U=q[1],V=function(e){m(e)},J=function(){e.closeDialog(),l(!1),P({message:null,color:null}),x(""),C(""),R(""),D(""),m(new Date),z("null")};return h!==O.current&&(C(""),O.current=h,z(Math.random())),Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(yn.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:s,onClose:J,children:[Object(a.jsx)(vn.a,{children:"Schedule an action"}),Object(a.jsxs)(Gn.a,{dividers:!0,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(xt,{sensors:e.sensors,isCommandSensor:!0,selectSensor:x})}),""===h?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(ft,{type:h.type,selectCommand:C,clearEntries:M})}),Object(a.jsxs)(dt.a,{utils:lt.a,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(ut.a,{margin:"normal",id:"date-picker-dialog",label:"Starting Date Picker",format:"MM/dd/yyyy",value:j,onChange:V,KeyboardButtonProps:{"aria-label":"change date"}})}),Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(pt.a,{margin:"normal",id:"time-picker",label:"Starting Time Picker",value:j,onChange:V,KeyboardButtonProps:{"aria-label":"change time"}})})]}),Object(a.jsx)(kt,{selectRecurrence:R,selectTimeUnits:D}),W.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:W.color},children:W.message}),Object(a.jsx)("br",{})]})]}),Object(a.jsx)(En.a,{children:!0===_?Object(a.jsx)(Ue.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{className:n.cancelButton,variant:"contained",onClick:J,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",onClick:function(){P({message:null,color:null}),U(!0),N.a.post(w+"api/timerActions",{sensorType:h.type,sensorName:h.name,deviceId:h.deviceId,roomName:h.room,command:y,commandTopic:h.commandTopic,registrationDate:Date.now(),timestamp:j,recurrenceTimeUnit:B,recurrenceNumber:S}).then((function(n){e.updateActions(n.data._id),U(!1),P({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),P({message:e.response.data.message,color:"red"})),U(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var wt=Object(vt.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:14,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(yt.a),Rt=Object(v.a)((function(e){return{margin:{margin:e.spacing(1)}}}));function Tt(e){var n=Rt(),t=i.a.useState(""),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(""),u=Object(r.a)(d,2),p=u[0],j=u[1];return Object(c.useEffect)((function(){l(""),j("")}),[e.clearEntries]),Object(a.jsxs)("div",{children:[Object(a.jsxs)(gt.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(jt.a,{required:!0,id:"demo-customized-select-label",children:"Compare"}),Object(a.jsxs)(bt.a,{labelId:"demo-customized-select-label",id:"demo-customized-select",value:p,onChange:function(n){j(n.target.value),e.selectComparison(n.target.value)},input:Object(a.jsx)(wt,{}),children:[Object(a.jsx)(mt.a,{value:"",children:Object(a.jsx)("em",{children:"None"})}),Object(a.jsx)(mt.a,{value:"Below",children:"Below"}),Object(a.jsx)(mt.a,{value:"Over",children:"Over"}),Object(a.jsx)(mt.a,{value:"Equal To",children:"Equal To"})]})]}),Object(a.jsxs)(gt.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(jt.a,{required:!0,htmlFor:"demo-customized-textbox",children:"Quantity"}),Object(a.jsx)(wt,{type:"number",id:"demo-customized-textbox",value:s,onChange:function(n){l(n.target.value),e.selectQuantity(n.target.value)}})]})]})}var At=Object(v.a)((function(e){return{formControl:{minWidth:130},menuItem:{padding:e.spacing(1)}}}));function Bt(e){var n=At(),t=i.a.useState(""),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(!1),u=Object(r.a)(d,2),p=u[0],j=u[1];Object(c.useEffect)((function(){l("")}),[e.clearEntries]);var m=function(e){switch(e){case re:return[le,ue];case je:return[me];case ce:return[ie]}}(e.type);return Object(a.jsx)("div",{children:Object(a.jsxs)(gt.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(jt.a,{id:"demo-controlled-open-select-label",children:"Measurement"}),Object(a.jsx)(bt.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:p,onClose:function(){j(!1)},onOpen:function(){j(!0)},value:s,onChange:function(n){l(n.target.value),e.selectMeasurementType(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(mt.a,{value:e,children:e},n)})):null})]})})}var Dt=Object(v.a)((function(e){return{formControl:{minWidth:120},menuItem:{padding:e.spacing(1)}}}));function Lt(e){var n=Dt(),t=i.a.useState(""),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(!1),u=Object(r.a)(d,2),p=u[0],j=u[1];Object(c.useEffect)((function(){l("")}),[e.clearEntries]);var m=function(e){switch(e){case ie:return[oe,se]}}(e.outputType);return Object(a.jsx)("div",{children:Object(a.jsxs)(gt.a,{required:!0,className:n.formControl,children:[Object(a.jsx)(jt.a,{id:"demo-controlled-open-select-label",children:"Option"}),Object(a.jsx)(bt.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:p,onClose:function(){j(!1)},onOpen:function(){j(!0)},value:s,onChange:function(n){l(n.target.value),e.selectOption(n.target.value)},children:m?m.map((function(e,n){return Object(a.jsx)(mt.a,{value:e,children:e},n)})):null})]})})}var Ft=Object(v.a)((function(e){return{root:{display:"flex"},wrapDiv:{display:"flex",justifyContent:"flex-start",flexDirection:"column"},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)},label:{marginTop:e.spacing(2),marginBottom:e.spacing(2),paddingLeft:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px"}}}));function Mt(e){var n=Ft(),t=i.a.useState(!0),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(""),u=Object(r.a)(d,2),j=u[0],m=u[1],g=Object(c.useRef)(j),b=i.a.useState(""),h=Object(r.a)(b,2),x=h[0],O=h[1],v=Object(c.useRef)(x),y=i.a.useState(""),C=Object(r.a)(y,2),k=C[0],I=C[1],S=i.a.useState(""),R=Object(r.a)(S,2),T=R[0],A=R[1],B=i.a.useState(""),D=Object(r.a)(B,2),L=D[0],F=D[1],M=i.a.useState(""),z=Object(r.a)(M,2),E=z[0],G=z[1],W=i.a.useState(""),P=Object(r.a)(W,2),H=P[0],q=P[1],_=i.a.useState(null),U=Object(r.a)(_,2),V=U[0],J=U[1],K=i.a.useState(null),Q=Object(r.a)(K,2),Y=Q[0],X=Q[1],Z=i.a.useState({message:null,color:null}),$=Object(r.a)(Z,2),ee=$[0],ne=$[1],te=i.a.useState(!1),ae=Object(r.a)(te,2),ce=ae[0],ie=ae[1],oe=function(){e.closeDialog(),l(!1),ne({message:null,color:null}),O(""),m(""),I(""),A(""),F(""),G(""),q(""),J(null),X(null)};x!==v.current&&(I(""),v.current=x,X(Math.random())),j!==g.current&&(A(""),F(""),G(""),q(""),g.current=j,J(Math.random()));var se=null;return"measurement"===Ne(j.type)?se=Object(a.jsx)(Tt,{selectComparison:G,selectQuantity:F,clearEntries:V}):"options"===Ne(j.type)&&(se=""===T?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Lt,{selectOption:q,outputType:T})})),Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(yn.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:s,onClose:oe,children:[Object(a.jsx)(vn.a,{children:"Sensor-Based Action"}),Object(a.jsx)(Gn.a,{dividers:!0,children:Object(a.jsxs)("div",{className:n.wrapDiv,children:[Object(a.jsxs)("div",{className:n.picker,children:[Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"Trigger"}),Object(a.jsx)(xt,{sensors:e.sensors,selectSensor:O,isCommandSensor:!0})]}),""===x?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(ft,{type:x.type,selectCommand:I,clearEntries:Y})}),Object(a.jsxs)("div",{className:n.picker,children:[Object(a.jsx)(f.a,{className:n.label,variant:"subtitle1",children:"When"}),Object(a.jsx)(xt,{sensors:e.sensors,selectSensor:m,isCommandSensor:!1})]}),""===j?null:Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(Bt,{type:j.type,selectMeasurementType:A,clearEntries:V})}),se]}),ee.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:ee.color},children:ee.message}),Object(a.jsx)("br",{})]})]})}),Object(a.jsx)(En.a,{children:!0===ce?Object(a.jsx)(Ue.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{className:n.cancelButton,variant:"contained",onClick:oe,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",onClick:function(){var n;(ne({message:null,color:null}),ie(!0),x)&&(n=ye(x.type,k).commandOnFailure);N.a.post(w+"api/sensorBasedActions",{sensorType:x.type,sensorName:x.name,deviceId:x.deviceId,roomName:x.room,command:k,commandTopic:x.commandTopic,registrationDate:Date.now(),measurementSensorName:j.name,measurementDeviceId:j.deviceId,measurementRoomName:j.room,measurementSensorType:j.type,commandOnFailure:n,comparisonType:E,quantity:L,measurementType:T,option:H}).then((function(n){e.updateActions(n.data._id),ie(!1),ne({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),ne({message:e.response.data.message,color:"red"})),ie(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var zt=t(196),Et=t.n(zt),Gt=function(e){BackgroundGeolocation.configure({locationProvider:BackgroundGeolocation.ACTIVITY_PROVIDER,desiredAccuracy:BackgroundGeolocation.HIGH_ACCURACY,stationaryRadius:50,distanceFilter:500,notificationTitle:"Background Tracking",notificationText:"Enabled",debug:!0,interval:1e4,fastestInterval:5e3,activitiesInterval:1e4,url:"http://192.168.1.66:5000/api/location",httpHeaders:{"X-FOO":"bar"},postTemplate:{lat:"@latitude",lon:"@longitude"}}),BackgroundGeolocation.on("location",(function(e){console.log(e),BackgroundGeolocation.startTask((function(e){BackgroundGeolocation.endTask(e)}))})),BackgroundGeolocation.on("stationary",(function(e){})),BackgroundGeolocation.on("error",(function(e){console.log("[ERROR] BackgroundGeolocation error:",e.code,e.message)})),BackgroundGeolocation.on("start",(function(){console.log("[INFO] BackgroundGeolocation service has been started")})),BackgroundGeolocation.on("stop",(function(){console.log("[INFO] BackgroundGeolocation service has been stopped")})),BackgroundGeolocation.on("authorization",(function(e){console.log("[INFO] BackgroundGeolocation authorization status: "+e),e!==BackgroundGeolocation.AUTHORIZED&&setTimeout((function(){if(confirm("App requires location tracking permission.\nIf you are willing to give all the required permissions, restart the app for the changes to take effect.\nWould you like to open app settings? "))return BackgroundGeolocation.showAppSettings()}),1e3)})),BackgroundGeolocation.on("background",(function(){console.log("[INFO] App is in background")})),BackgroundGeolocation.on("foreground",(function(){console.log("[INFO] App is in foreground")})),BackgroundGeolocation.on("abort_requested",(function(){console.log("[INFO] Server responded with 285 Updates Not Required")})),BackgroundGeolocation.on("http_authorization",(function(){console.log("[INFO] App needs to authorize the http requests")})),BackgroundGeolocation.checkStatus((function(n){console.log("[INFO] BackgroundGeolocation service is running",n.isRunning),console.log("[INFO] BackgroundGeolocation services enabled",n.locationServicesEnabled),console.log("[INFO] BackgroundGeolocation auth status: "+n.authorization),console.log(n.isRunning),!n.isRunning&&n.locationServicesEnabled?(BackgroundGeolocation.start(),e(!0)):n.isRunning||BackgroundGeolocation.removeAllListeners()}))};document.addEventListener("deviceready",Gt,!1);var Wt=Object(vt.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:14,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"])}}}))(yt.a),Pt=Object(v.a)((function(e){return{margin:{margin:e.spacing(1),paddingTop:e.spacing(1)}}}));function Ht(e){var n=Pt(),t=i.a.useState(""),c=Object(r.a)(t,2),o=c[0],s=c[1];return Object(a.jsx)("div",{children:Object(a.jsxs)(gt.a,{className:n.margin,focused:!0,children:[Object(a.jsx)(jt.a,{required:!0,htmlFor:"demo-customized-textbox",children:"Radius in meters (Minimum: 100)"}),Object(a.jsx)(Wt,{type:"number",id:"demo-customized-textbox",value:o,onChange:function(n){s(n.target.value),e.selectRadius(n.target.value)}})]})})}var qt=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},extendedIcon:{marginRight:e.spacing(1)},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(4)},picker:{padding:e.spacing(1)},cancelButton:{marginRight:e.spacing(1)},label:{marginTop:e.spacing(2),marginBottom:e.spacing(2),padding:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",borderRadius:"10px"}}}));function _t(e){var n=qt(),t=i.a.useState(!0),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(""),u=Object(r.a)(d,2),j=u[0],m=u[1],g=Object(c.useRef)(j),b=i.a.useState(""),h=Object(r.a)(b,2),x=h[0],O=h[1],f=i.a.useState(""),v=Object(r.a)(f,2),y=v[0],C=v[1],k=i.a.useState(null),I=Object(r.a)(k,2),S=I[0],R=I[1],T=i.a.useState({message:null,color:null}),A=Object(r.a)(T,2),B=A[0],D=A[1],L=i.a.useState(!1),F=Object(r.a)(L,2),M=F[0],z=F[1],E=function(){e.closeDialog(),l(!1),D({message:null,color:null}),m(""),O(""),C(""),R("null")};return j!==g.current&&(O(""),g.current=j,R(Math.random())),Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(yn.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:s,onClose:E,children:[Object(a.jsx)(vn.a,{children:"Location-Based Action"}),Object(a.jsxs)(Gn.a,{dividers:!0,children:[Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(xt,{sensors:e.sensors,isCommandSensor:!0,selectSensor:m})}),""===j?null:Object(a.jsx)("div",{className:n.picker,children:Object(a.jsx)(ft,{type:j.type,selectCommand:O,clearEntries:S})}),Object(a.jsx)(Ht,{selectRadius:C}),B.message&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("small",{style:{color:B.color},children:B.message}),Object(a.jsx)("br",{})]})]}),Object(a.jsx)(En.a,{children:!0===M?Object(a.jsx)(Ue.a,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)(p.a,{className:n.cancelButton,variant:"contained",onClick:E,color:"primary",children:"Cancel"}),Object(a.jsx)(p.a,{variant:"contained",onClick:function(){D({message:null,color:null}),z(!0),N.a.post(w+"api/locationBasedActions",{sensorType:j.type,sensorName:j.name,deviceId:j.deviceId,roomName:j.room,command:x,commandTopic:j.commandTopic,registrationDate:Date.now(),radius:y}).then((function(n){e.updateActions(n.data._id),z(!1),D({message:"Action added successfully",color:"green"})})).catch((function(e){e.response&&(console.log(e.response.data.message),D({message:e.response.data.message,color:"red"})),z(!1)}))},color:"primary",children:"Add Action"})]})})]})})}var Ut=Object(v.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function Vt(e){var n=Ut(),t=i.a.useState(!0),o=Object(r.a)(t,2),s=o[0],l=o[1],d=i.a.useState(null),u=Object(r.a)(d,2),j=u[0],m=u[1];Object(c.useEffect)((function(){var e;e=m,BackgroundGeolocation.checkStatus((function(n){console.log("[INFO] BackgroundGeolocation service is running",n.isRunning),console.log("[INFO] BackgroundGeolocation services enabled",n.locationServicesEnabled),console.log("[INFO] BackgroundGeolocation auth status: "+n.authorization),1===n.authorization?e(!0):e(!1),console.log(n.authorization)}))}),[]);var g=function(){e.closeDialog(),l(!1)},b=null;return null!==j&&(j?b=Object(a.jsx)(_t,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:e.closeDialog}):(BackgroundGeolocation.removeAllListeners(),b=Object(a.jsxs)(yn.a,{open:s,onClose:g,children:[Object(a.jsx)(vn.a,{children:"Location-Based Action"}),Object(a.jsx)(Gn.a,{dividers:!0,children:"When prompted, you must accept all asked permissions in order for the location services of this app to work. Otherwise this feature will remain disabled."}),Object(a.jsx)(En.a,{children:Object(a.jsx)(p.a,{variant:"contained",onClick:function(){Gt(m),g()},color:"primary",children:"Enable Location Services"})})]}))),Object(a.jsx)("div",{className:n.root,children:b})}var Jt=Object(v.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},action:{margin:e.spacing(2),backgroundColor:e.palette.primary.main}}}));function Kt(e){var n=Jt(),t=i.a.useState(!1),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(null),d=Object(r.a)(l,2),u=d[0],p=d[1],j=function(){p(null)},m=null;switch(u){case"timerAction":m=Object(a.jsx)(St,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:j});break;case"sensorBasedAction":m=Object(a.jsx)(Mt,{sensors:e.sensors,updateActions:e.updateActions,closeDialog:j});break;case"locationBasedAction":m=Object(a.jsx)(Vt,{closeDialog:j,sensors:e.sensors,updateActions:e.updateActions})}return Object(a.jsx)("div",{className:n.root,children:Object(a.jsxs)(tt.a,{ariaLabel:"SpeedDial openIcon",className:n.speedDial,icon:Object(a.jsx)(at.a,{openIcon:Object(a.jsx)(Et.a,{})}),onClose:function(){s(!1)},onOpen:function(){s(!0)},open:o,children:[Object(a.jsx)(ct.a,{className:n.action,icon:Object(a.jsx)(Xe.a,{}),tooltipTitle:"Sensor Based",onClick:function(){p("sensorBasedAction")}}),Object(a.jsx)(ct.a,{className:n.action,icon:Object(a.jsx)(rt.a,{}),tooltipTitle:"Location Based",onClick:function(){p("locationBasedAction")}}),Object(a.jsx)(ct.a,{className:n.action,icon:Object(a.jsx)(ot.a,{}),tooltipTitle:"Time Based",onClick:function(){p("timerAction")}}),m]})})}var Qt=w+"api/actions",Yt=Object(v.a)((function(e){return{root:{margin:e.spacing(1)}}}));function Xt(e){var n=Yt(),t=Object(c.useState)({actions:[],isFetching:!1}),i=Object(r.a)(t,2),o=i[0],s=i[1],l=Object(c.useState)(null),d=Object(r.a)(l,2),u=d[0],p=d[1],j=function(e){p(e)};return Object(c.useEffect)((function(){return function(){var e=Object(H.a)(W.a.mark((function e(){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s({actions:[],isFetching:!0}),e.next=4,N.a.get(Qt);case 4:n=e.sent,s({actions:n.data,isFetching:!1}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),s({actions:[],isFetching:!1});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}()(),function(){console.log("unmounting actions")}}),[u]),Object(a.jsxs)("div",{className:n.root,children:[0!==o.actions.length?o.actions.map((function(e){return Object(a.jsx)("div",{className:n.root,children:Object(a.jsx)(nt,{action:e,updateActions:j})},e._id)})):Object(a.jsx)(un,{displayItem:"Actions"}),Object(a.jsx)(Kt,{sensors:e.sensors,updateActions:j})]})}var Zt=Object(v.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(1)},title:{flexGrow:1}}}));function $t(e){var n=Zt(),t=i.a.useState({open:!1,dialogItems:null}),c=Object(r.a)(t,2),o=c[0],s=c[1],l=i.a.useState(void 0),d=Object(r.a)(l,2),u=d[0],j=d[1];return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(Ae.a,{position:"static",children:Object(a.jsxs)(Be.a,{variant:"dense",children:[Object(a.jsx)(p.a,{size:"small",onClick:e.showAllSensors,color:"inherit",children:"All"}),Object(a.jsx)(p.a,{size:"small",onClick:function(){s({open:!0,dialogItems:{contents:e.rooms,name:"Rooms",type:"room"}})},color:"inherit",children:"Rooms"}),Object(a.jsx)(p.a,{size:"small",onClick:function(){s({open:!0,dialogItems:{contents:e.categories,name:"Sensor Types",type:"sensor-type"}})},color:"inherit",children:"Types"})]})}),null!==o.dialogItems?Object(a.jsx)(Tn,{name:o.dialogItems.name,type:o.dialogItems.type,contents:o.dialogItems.contents,selectedValue:u,open:o.open,onClose:function(n){s({open:!1,dialogItems:null}),j(n),n&&e.selectItem({selected:n,type:o.dialogItems.type})}}):null]})}function ea(){return Object(a.jsxs)(f.a,{variant:"body2",color:"textPrimary",align:"center",children:["Copyright \xa9 ","Home Automation ",(new Date).getFullYear(),"."]})}var na=Object(v.a)((function(e){return{root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(L.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{backgroundColor:e.palette.secondary.main,zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:200,width:"calc(100% - ".concat(200,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1,paddingTop:5},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:200,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(we.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.down("sm"),{width:e.spacing(0)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(1),display:"flex",overflow:"auto",flexDirection:"column",borderRadius:"10px",backgroundColor:e.palette.secondary.main},primaryAction:Object(we.a)({borderRadius:"10px"},e.breakpoints.down("sm"),{display:"none"}),dashBoardLabel:{},currentTab:{textAlign:"center",marginTop:e.spacing(2)},hiMessage:{marginRight:e.spacing(2)},behindBackground:{backgroundImage:"url(".concat(S,"/static/media/home-automation4.cc5ee920.svg)"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:"100vw",height:"100vh"}}}));var ta=Object(d.g)((function(e){var n=na(),t=i.a.useState(!1),c=Object(r.a)(t,2),o=c[0],s=c[1],d=i.a.useState({selected:"All",type:"all"}),u=Object(r.a)(d,2),m=u[0],h=u[1],x=function(){k(),e.history.push("/login")},O=function(){s(!1)},v=function(){h({selected:"All",type:"all"})},y={tab:"All",content:null};switch(m.type){case"room":y.tab="Room",y.content=m.selected;break;case"sensor-type":y.tab="Sensor Type",y.content=m.selected;break;case"actions":y.tab="Actions",y.content=null;break;default:y.tab="All",y.content=null}var N=Object(Se.a)(new Set(e.sensors.map((function(e){return e.room})))),C=Object(Se.a)(new Set(e.sensors.map((function(e){return e.type})))),I=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}();return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(j.a,{}),Object(a.jsx)(Ae.a,{position:"absolute",className:Object(Re.a)(n.appBar,o&&n.appBarShift),children:Object(a.jsxs)(Be.a,{className:n.toolbar,children:[Object(a.jsx)(Fe.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){s(!0)},className:Object(Re.a)(n.menuButton,o&&n.menuButtonHidden),children:Object(a.jsx)(Ee.a,{})}),Object(a.jsx)("div",{className:n.title,children:Object(a.jsx)(Bn.a,{href:"/",component:l.b,to:"/",color:"primary",underline:"none",variant:"h5",children:Object(a.jsx)("img",{src:"".concat(S,"/static/media/home-automation.1ec2cf5b.svg"),alt:"",height:50})})}),Object(a.jsxs)(f.a,{variant:"body2",className:n.hiMessage,children:["Hi, ",I.name]}),Object(a.jsx)(p.a,{variant:"contained",className:n.primaryAction,onClick:x,color:"primary",children:"Log Out"})]})}),Object(a.jsxs)(Te.a,{variant:"temporary",classes:{paper:Object(Re.a)(n.drawerPaper,!o&&n.drawerPaperClose)},open:o,onClose:O,children:[Object(a.jsx)("div",{className:n.toolbarIcon,children:Object(a.jsx)(Fe.a,{onClick:O,children:Object(a.jsx)(We.a,{})})}),Object(a.jsx)(Le.a,{}),Object(a.jsxs)(De.a,{children:[Object(a.jsxs)(Pe.a,{button:!0,onClick:v,children:[Object(a.jsx)(He.a,{children:Object(a.jsx)(gn.a,{color:"primary"})}),Object(a.jsx)(qe.a,{primary:"All"})]}),Object(a.jsx)(An,{contents:N,selectItem:h,name:"Rooms",type:"room"}),Object(a.jsx)(An,{contents:C,selectItem:h,name:"Sensor Types",type:"sensor-type"})]}),Object(a.jsx)(Le.a,{}),Object(a.jsxs)(De.a,{children:[Object(a.jsxs)(Pe.a,{button:!0,onClick:function(){h({selected:"Actions",type:"actions"})},children:[Object(a.jsx)(He.a,{children:Object(a.jsx)(hn.a,{color:"primary"})}),Object(a.jsx)(qe.a,{primary:"Actions"})]}),Object(a.jsxs)(Pe.a,{button:!0,onClick:x,children:[Object(a.jsx)(He.a,{children:Object(a.jsx)(On.a,{color:"primary"})}),Object(a.jsx)(qe.a,{primary:"Log Out"})]})]})]}),Object(a.jsx)("div",{className:n.behindBackground,children:Object(a.jsxs)("main",{className:n.content,children:[Object(a.jsx)("div",{className:n.appBarSpacer}),Object(a.jsx)($t,{selectItem:h,rooms:N,categories:C,showAllSensors:v}),Object(a.jsxs)("div",{className:n.currentTab,children:[Object(a.jsx)(f.a,{variant:"h5",gutterBottom:!0,className:n.dashBoardLabel,children:"Dashboard"}),Object(a.jsxs)(f.a,{variant:"h6",children:[y.tab,"All"===y.tab||"Actions"===y.tab?null:" | ",y.content]})]}),Object(a.jsxs)(Me.a,{maxWidth:"lg",className:n.container,children:["Actions"===m.selected?Object(a.jsx)("div",{children:Object(a.jsx)(g.a,{className:n.paper,elevation:10,children:Object(a.jsx)(Xt,{sensors:e.sensors})})}):Object(a.jsx)(jn,{sensors:e.sensors,filtered:m.type,selected:m.selected}),Object(a.jsx)(b.a,{pt:4,children:Object(a.jsx)(ea,{})})]})]})})]})})),aa=w+"api/activeSensors",ca=function(){var e=Object(c.useState)({sensors:[]}),n=Object(r.a)(e,2),t=n[0],i=n[1],o=Object(c.useRef)(t);return Object(c.useEffect)((function(){(function(){var n=Object(H.a)(W.a.mark((function n(){var t,a,c,s;return W.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,N.a.get(aa);case 3:t=n.sent,i({sensors:t.data}),o.current={sensors:t.data},a=Object(P.a)(t.data);try{for(a.s();!(c=a.n()).done;)s=c.value,K.subscribe(e,s.pubTopic)}catch(r){a.e(r)}finally{a.f()}n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0),i({sensors:[]});case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}})()();var e=K.getClient();console.log(e);var n=function(n,t,a){if(console.log(t.toString(),n),"browser"!==n);else{var c=JSON.parse(t.toString());if("disconnected"===c.action){var s={sensors:o.current.sensors.filter((function(n){return n.deviceId===c.deviceId&&K.unsubscribe(e,n.pubTopic),n.deviceId!==c.deviceId})),alertMessage:{device:c.deviceId,reason:c.action}};o.current=s,i(s)}else if("connected"===c.action){if(o.current.sensors.find((function(e){return e.deviceId===c.newSensors[0].deviceId})))return void console.log("Exists!!! No action taken!");var r,l={sensors:o.current.sensors.concat(c.newSensors),alertMessage:{device:c.newSensors[0].deviceId,reason:c.action}},d=Object(P.a)(c.newSensors);try{for(d.s();!(r=d.n()).done;){var u=r.value;K.subscribe(e,u.pubTopic)}}catch(j){d.e(j)}finally{d.f()}o.current=l,i(l)}else if("action"===c.action){console.log(c);var p={sensors:o.current.sensors,alertMessage:{reason:c.action,actionCategory:c.actionInfo.actionCategory,command:c.actionInfo.command,roomName:c.actionInfo.roomName,sensorType:c.actionInfo.sensorType}};o.current=p,i(p)}}};return e.on("message",n),function(){console.log("Dashboard was unmounted!"),e.off("message",n)}}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)(Ie,{alertMessage:t.alertMessage}),Object(a.jsx)(ta,{sensors:t.sensors,alertMessage:t.alertMessage})]})};t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p,t.p;var ia=function(){var e=Object(c.useState)(!0),n=Object(r.a)(e,2),t=n[0],i=n[1];return Object(c.useEffect)((function(){var e=C();e&&N.a.get("http://localhost:5000/api/verifyToken?token=".concat(e)).then((function(e){I(e.data.token,e.data.user),i(!1)})).catch((function(e){alert(e),k(),i(!1)}))}),[]),t&&C()?Object(a.jsx)("div",{className:"content",children:"Checking Authentication..."}):Object(a.jsx)(l.a,{children:Object(a.jsxs)(d.d,{children:[Object(a.jsx)(M,{path:"/dashboard",component:ca}),Object(a.jsx)(E,{path:"/",component:B})]})})},oa=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,404)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),i(e),o(e)}))},sa=t(386),ra=t(206),la=Object(ra.a)({palette:{background:{default:"#FFF",emphasis:"#E8EAF6",secondary:"#C5CAE9",header:"#121037"},text:{primary:"#615f5d",secondary:"#999693",hint:"#ccc8c4",whiteText:"white"},primary:{main:"#383838",light:"#333333",dark:"#545454"},secondary:{main:"#b09058",light:"#deb66f",dark:"#9c7f4e"},contrastThreshold:1.8}}),da=function(){s.a.render(Object(a.jsxs)(sa.a,{theme:la,children:[Object(a.jsx)(j.a,{}),Object(a.jsx)(ia,{})]}),document.getElementById("root"))};window.cordova?document.addEventListener("deviceready",(function(){da()}),!1):da(),oa()}},[[317,1,2]]]);
//# sourceMappingURL=main.7e6e215e.chunk.js.map